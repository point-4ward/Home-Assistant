#TODO - set the media player correctly here with a script
media_player: media_player.livingroom
message: >
  {%- macro greeting() -%}
    {% if now().strftime('%H')|int < 12 and now().strftime('%H')|int > 6 %}
      {% set greeting = ["Hello, " , "Good Morning, " , "Hey Guys! "] %}
    {% elif now().strftime('%H')|int >= 12 and now().strftime('%H')|int < 17 %}
      {% set greeting = ["Hey there! " , "Good afternoon, " , "Hi there, "] %}
    {% else %}
      {% set greeting = ["Hi, " , "Good evening, " , "Hello, "] -%}
    {% endif %}
    {{ greeting|random }}
  {%- endmacro -%}

  {%- macro inform() -%}
    {{ ["I just want to inform you that ", "I just want to let you know that ",
      "You asked me to inform you when ", "I thought you'd like to know that "]|random }}
  {%- endmacro -%}

  {%- macro unknown() -%}
    {{ ["Hmm, I don't know ", "I wish I knew ",
      "My programming prohibits me from telling you "] | random }}
  {%- endmacro -%}

  {%- macro error() %}
    {{["I don't understand. Given the situation it's far safer to initiate the self-destruct. ",
      "If I stand next to a powerful array of magnets, I do get pretty loopy. ",
      "I don't know what just happened, but I'm happy you're happy. ",
      "That glitch appears to have been limited to this building. ",
      "I don't seem to be getting better. ", "Here's a cactus! ",
      "Hi guys! I'm broken! "] | random }}
  {%- endmacro -%}

  {%- macro okay()-%}
    {{["Done!", "Extraordinarily bad idea. Oh well.. ",
      "Funny, I was just about to do that. " , "Here you go. ",
      "I'll do that. ", "Of course! ", "Of course! Glad to help. ",
      "OK " , "Okie-dokie " ,  "Sure " , "Sure thing! ",
      "There. Happy to help. " , "There you go! ",
      "I will not! Just kidding. " , "Yup. Sorted!"
      "I couldn't do this 800 reboots ago, but apparently now I can. "] |random }}
  {%- endmacro -%}

  {%- macro bye() -%}
    {{["Adios! " , "Bye Guys! " , "See ya! " , "See you later. ",
      "Untill next time!"] | random }}
  {%- endmacro -%}

  {%- macro dark_outside() -%}
    {{ ['It is pretty dark outside. I will turn on the lights now.',
      'I will switch on the lights. It is getting dark outside.',
      'Time to turn on the lights. I will take care of it.']|random }}
  {%- endmacro -%}

  {%- macro iss() -%}
    {% if is_state('binary_sensor.iss', 'on') -%}
      Here is something interesting. The international space station is above us now. There are {{ states.binary_sensor.iss.attributes['number_of_people_in_space'] }} people in space right now.
      {{ outside_weather() }}
    {% endif -%}
  {%- endmacro -%}

  {%- macro moon() -%}
    {%- if states.sensor.moon.state == 'Full moon' -%}
      Check out the full moon tonight!
    {%- endif -%}
  {%- endmacro -%}


  {# ********************************************* #}
  {#  ******** Start the Speech routines ********  #}
  {# ********************************************* #}


  {% if call_greeting == 1 %}
    {{ greeting() }}
  {% endif %}

  {% if call_introduction == 1 %}
    {{ introduction() }}
  {% endif %}

  {% if call_update == 1 %}
    {{ update() }}
  {% endif%}

  {% if call_okay == 1 %}
    {{ okay () }}
  {% endif %}

  {% if call_inform == 1 %}
    {{ inform() }}
  {% endif %}

  {% if call_poweron == 1 %}
    {% if is_state ('input_boolean.maintenance_mode' , 'on') %} the system is back online
    {% else %} Home Assistant has restarted and is not in Maintenance Mode.  Is it a power cut? {% endif %}
  {% endif %}

  {% if call_dark_outside == 1 %}
    {{ dark_outside() }}
  {% endif %}

  {{ message }}

  {{ ([iss, moon]|random)() }}

  {% if call_bye == 1 %}
    {{ bye() }}
  {% endif %}
