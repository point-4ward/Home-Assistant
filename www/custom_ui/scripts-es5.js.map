{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///../home-assistant-polymer/src/common/dom/apply_themes_on_element.js","webpack:///../home-assistant-polymer/src/common/entity/compute_domain.js","webpack:///../home-assistant-polymer/src/common/entity/compute_state_domain.js","webpack:///../home-assistant-polymer/src/common/dom/dynamic_content_updater.js","webpack:///../home-assistant-polymer/src/common/const.js","webpack:///../home-assistant-polymer/src/common/entity/state_card_type.js","webpack:///./node_modules/@polymer/polymer/lib/utils/html-tag.js","webpack:///./src/mixins/events-mixin.js","webpack:///./src/elements/ha-config-custom-ui.js","webpack:///./src/utils/hooks.js","webpack:///../home-assistant-polymer/src/common/entity/get_view_entities.js","webpack:///../home-assistant-polymer/src/common/entity/get_group_entities.js","webpack:///./src/utils/version.js","webpack:///./src/elements/cui-base-element.js","webpack:///./src/elements/dynamic-element.js","webpack:///./src/elements/dynamic-with-extra.js","webpack:///./src/elements/ha-themed-slider.js","webpack:///./src/elements/state-card-with-slider.js","webpack:///./src/elements/state-card-without-slider.js","webpack:///./src/elements/state-card-custom-ui.js","webpack:///../home-assistant-polymer/src/common/entity/can_toggle_state.js","webpack:///../home-assistant-polymer/src/common/entity/can_toggle_domain.js","webpack:///./node_modules/@polymer/polymer/lib/utils/boot.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","r","value","n","__esModule","default","object","property","prototype","hasOwnProperty","p","s","__webpack_exports__","applyThemesOnElement","element","themes","localTheme","updateMeta","arguments","length","_themes","themeName","default_theme","styles","assign","theme","keys","forEach","key","prefixedKey","window","ShadyCSS","styleSubtree","meta","document","querySelector","hasAttribute","setAttribute","getAttribute","themeColor","computeDomain","entityId","substr","indexOf","computeStateDomain","stateObj","_domain","entity_id","dynamicContentUpdater","root","newElementTag","attributes","rootEl","customEl","lastChild","tagName","removeChild","createElement","toLowerCase","setProperties","parentNode","appendChild","DOMAINS_WITH_CARD","_createClass","defineProperties","target","props","descriptor","writable","Constructor","protoProps","staticProps","LiteralString","string","this","toString","strings","raw","html","template","_len","values","Array","_key","innerHTML","reduce","acc","v","idx","HTMLTemplateElement","Error","literalValue","ha_config_custom_ui_createClass","_templateObject","freeze","ha_config_custom_ui_HaConfigCustomUi","superClass","Polymer","Element","_superClass","EventsMixin","instance","TypeError","__proto__","getPrototypeOf","apply","subClass","create","constructor","setPrototypeOf","events_mixin_createClass","type","detail","options","event","Event","bubbles","cancelable","Boolean","composed","node","dispatchEvent","HaConfigCustomUi","customUI","getName","setName","history","back","fire","isWide","String","observer","customElements","define","SUPPORTED_SLIDER_MODES","domHost","elem","getRootNode","DocumentFragment","host","lightOrShadow","selector","shadowRoot","getElementHierarchy","hierarchy","shift","getContext","_context","groupEntity","push","states","reverse","findMatch","find","option","match","maybeChangeObjectByDevice","device","applyAttributes","maybeChangeObjectByGroup","_this","context","group","_setKeep","obj","_cui_keep","maybeApplyTemplateAttributes","hass","templates","newAttributes","hasGlobal","hasChanges","computeTemplate","untemplated_attributes","untemplated_state","state","_stateDisplay","result","untemplated_stateDisplay","maybeApplyTemplates","newResult","checkAttributes","last_changed","maybeChangeObject","inDialog","allowHidden","hidden","fixGroupTitles","homeAssistantMain","haCards","$","main","querySelectorAll","card","friendly_name","textContent","setTimeout","controlColumns","columns","partialCards","mqls","mql","removeListener","handleWindowChange","map","width","matchMedia","addListener","bind","useCustomizer","customizer","hide_attributes","hassAttributeUtil","LOGIC_STATE_ATTRIBUTES","attr","updateAttributes","customUiAttributes","state_card_mode","light","concat","cover","*","state_card_custom_ui_secondary","badges_list","show_last_changed","hide_control","extra_data_template","extra_badge","stretch_slider","slider_theme","confirm_controls","confirm_controls_show_lock","hide_in_default_view","updateConfigPanel","location","pathname","startsWith","haPanelConfig","haConfigNavigation","localize","cuiPatch","_originalComputeLoaded","_computeLoaded","_originalComputeCaption","_computeCaption","_originalComputeDescription","_computeDescription","page","pages","some","conf","domain","caption","description","loaded","getHaConfigCustomUi","haConfigCustomUi","ironPages","lastElementChild","addEventListener","select","visible","style","display","installStatesHook","homeAssistant","_updateHass","originalUpdate","entity","newEntity","_themeWaiters","waiter","stateChanged","installPartialCards","_defaultViewFilter","excludes","excludeEntityId","view","entities","viewEntities","groupEntities","grEntityId","grEntity","installActionName","elementName","klass","action_name","__data","set","installHaStateLabelBadge","haStateLabelBadge","updateStyles","startInterval","installStateBadge","stateBadge","updateIconAppearance","originalUpdateIconAppearance","icon_color","entity_picture","backgroundImage","icon","color","filter","installClassHooks","classInitDone","init","initDone","runHooks","console","log","CUSTOM_UI_LIST","version","url","localStorage","getItem","setItem","attribute","functionBody","Function","e","SyntaxError","ReferenceError","warn","message","cui_base_element","extras","isArray","extra","controlElement","computed","CuiBaseElement","dynamic_element_createClass","dynamic_element_DynamicElement","toUpperCase","DynamicElement","dynamic_with_extra_DynamicWithExtra","dynamic_with_extra_createClass","DynamicWithExtra","dynamic_with_extra_get","_attached","_isAttached","attached","_this2","extraBadges","extraBadge","unit_of_measurement","unit","blacklist","blacklist_states","RegExp","test","_entityDisplay","extraObj","extraObjVisible","haLocalize","_this3","pointerEvents","lock","opacity","stopPropagation","_this4","applyThemes","dynamic_with_extra_templateObject","ha_themed_slider_HaThemedSlider","HaThemedSlider","disableOffWhenMin","_computeAttribute","computeEnabledThemedReportWhenNotChanged","disableReportWhenNotChanged","_enabledThemedReportWhenNotChanged","def","isOn","themedMin","ev","ha_themed_slider_templateObject","min","Number","max","pin","notify","_themedMin","state_card_with_slider_StateCardWithSlider","state_card_with_slider_get","StateCardWithSlider","_onIronResize","_isConnected","_waitForLayout","removeEventListener","_setMode","_frameId","readyToCompute","requestAnimationFrame","hideSlider","mode","lineTooLong","breakSlider","showSlider","prevBreakSlider","prevHideSlider","container","containerWidth","clientWidth","minLineBreak","maxLineBreak","containerHeight","clientHeight","stateHeight","stretchSlider","parseInt","param","isNaN","path","_slicedToArray","composedPath","_ev$composedPath","callService","serviceMin","setValueName","valueName","serviceMax","nameOn","sliderValue","state_card_with_slider_templateObject","state_card_without_slider_StateCardWithoutSlider","state_card_without_slider_templateObject","SHOW_LAST_CHANGED_BLACKLISTED_CARDS","DOMAIN_TO_SLIDER_SUPPORT","climate","TYPE_TO_CONTROL","toggle","state_card_custom_ui_StateCardCustomUi","state_card_custom_ui_get","StateCardCustomUi","classList","contains","_container","setProperty","inputChanged","margin","padding","id","includes","params","text-align","fontSize","modifiedObj","themeTarget","supported_features","maybeHideEntity","cleanBadgeStyle","originalStateCardType","services","config","control","stateCardType","customStateCardType","secondaryStateCardType","sliderEligible_","min_temp","max_temp","badgeMode","JSCompiler_renameProperty","prop"],"mappings":"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","file":"scripts-es5.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","/**\n * Apply a theme to an element by setting the CSS variables on it.\n *\n * element: Element to apply theme on.\n * themes: HASS Theme information\n * localTheme: selected theme.\n * updateMeta: boolean if we should update the theme-color meta element.\n*/\nexport default function applyThemesOnElement(element, themes, localTheme, updateMeta = false) {\n  if (!element._themes) {\n    element._themes = {};\n  }\n  let themeName = themes.default_theme;\n  if (localTheme === 'default' || (localTheme && themes.themes[localTheme])) {\n    themeName = localTheme;\n  }\n  const styles = Object.assign({}, element._themes);\n  if (themeName !== 'default') {\n    var theme = themes.themes[themeName];\n    Object.keys(theme).forEach((key) => {\n      var prefixedKey = '--' + key;\n      element._themes[prefixedKey] = '';\n      styles[prefixedKey] = theme[key];\n    });\n  }\n  // implement updateStyles() method of Polemer elements\n  if (window.ShadyCSS) {\n    window.ShadyCSS.styleSubtree(/** @type {!HTMLElement} */(element), styles);\n  }\n\n  if (!updateMeta) return;\n\n  const meta = document.querySelector('meta[name=theme-color]');\n  if (meta) {\n    if (!meta.hasAttribute('default-content')) {\n      meta.setAttribute('default-content', meta.getAttribute('content'));\n    }\n    const themeColor = styles['--primary-color'] || meta.getAttribute('default-content');\n    meta.setAttribute('content', themeColor);\n  }\n}\n","export default function computeDomain(entityId) {\n  return entityId.substr(0, entityId.indexOf('.'));\n}\n","import computeDomain from './compute_domain.js';\n\nexport default function computeStateDomain(stateObj) {\n  if (!stateObj._domain) {\n    stateObj._domain = computeDomain(stateObj.entity_id);\n  }\n\n  return stateObj._domain;\n}\n","/**\n * Update root's child element to be newElementTag replacing another existing child if any.\n * Copy attributes into the child element.\n */\nexport default function dynamicContentUpdater(root, newElementTag, attributes) {\n  const rootEl = root;\n  let customEl;\n\n  if (rootEl.lastChild && rootEl.lastChild.tagName === newElementTag) {\n    customEl = rootEl.lastChild;\n  } else {\n    if (rootEl.lastChild) {\n      rootEl.removeChild(rootEl.lastChild);\n    }\n    // Creating an element with upper case works fine in Chrome, but in FF it doesn't immediately\n    // become a defined Custom Element. Polymer does that in some later pass.\n    customEl = document.createElement(newElementTag.toLowerCase());\n  }\n\n  if (customEl.setProperties) {\n    customEl.setProperties(attributes);\n  } else {\n    // If custom element definition wasn't loaded yet - setProperties would be\n    // missing, but no harm in setting attributes one-by-one then.\n    Object.keys(attributes).forEach((key) => {\n      customEl[key] = attributes[key];\n    });\n  }\n\n  if (customEl.parentNode === null) {\n    rootEl.appendChild(customEl);\n  }\n}\n","/** Constants to be used in the frontend. */\n\n// Constants should be alphabetically sorted by name.\n// Arrays with values should be alphabetically sorted if order doesn't matter.\n// Each constant should have a description what it is supposed to be used for.\n\n/** Icon to use when no icon specified for domain. */\nexport const DEFAULT_DOMAIN_ICON = 'mdi:bookmark';\n\n/** Domains that have a state card. */\nexport const DOMAINS_WITH_CARD = [\n  'climate',\n  'cover',\n  'configurator',\n  'input_select',\n  'input_number',\n  'input_text',\n  'media_player',\n  'scene',\n  'script',\n  'timer',\n  'weblink',\n];\n\n/** Domains that should have the history hidden in the more info dialog. */\nexport const DOMAINS_MORE_INFO_NO_HISTORY = [\n  'camera',\n  'configurator',\n  'history_graph',\n  'scene',\n];\n\n/** States that we consider \"off\". */\nexport const STATES_OFF = [\n  'closed',\n  'off',\n  'unlocked',\n];\n\n/** Temperature units. */\nexport const UNIT_C = '°C';\nexport const UNIT_F = '°F';\n\n/** Entity ID of the default view. */\nexport const DEFAULT_VIEW_ENTITY_ID = 'group.default_view';\n","import canToggleState from './can_toggle_state.js';\nimport computeStateDomain from './compute_state_domain.js';\nimport { DOMAINS_WITH_CARD } from '../const.js';\n\nexport default function stateCardType(hass, stateObj) {\n  if (stateObj.state === 'unavailable') {\n    return 'display';\n  }\n\n  const domain = computeStateDomain(stateObj);\n\n  if (DOMAINS_WITH_CARD.includes(domain)) {\n    return domain;\n  } else if (canToggleState(hass, stateObj) &&\n             stateObj.attributes.control !== 'hidden') {\n    return 'toggle';\n  }\n  return 'display';\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\nimport './boot.js';\n\n/**\n * Class representing a static string value which can be used to filter\n * strings by asseting that they have been created via this class. The\n * `value` property returns the string passed to the constructor.\n */\nclass LiteralString {\n  constructor(string) {\n    /** @type {string} */\n    this.value = string.toString();\n  }\n  /**\n   * @return {string} LiteralString string value\n   */\n  toString() {\n    return this.value;\n  }\n}\n\n/**\n * @param {*} value Object to stringify into HTML\n * @return {string} HTML stringified form of `obj`\n */\nfunction literalValue(value) {\n  if (value instanceof LiteralString) {\n    return /** @type {!LiteralString} */(value).value;\n  } else {\n    throw new Error(\n        `non-literal value passed to Polymer's htmlLiteral function: ${value}`\n    );\n  }\n}\n\n/**\n * @param {*} value Object to stringify into HTML\n * @return {string} HTML stringified form of `obj`\n */\nfunction htmlValue(value) {\n  if (value instanceof HTMLTemplateElement) {\n    return /** @type {!HTMLTemplateElement } */(value).innerHTML;\n  } else if (value instanceof LiteralString) {\n    return literalValue(value);\n  } else {\n    throw new Error(\n        `non-template value passed to Polymer's html function: ${value}`);\n  }\n}\n\n/**\n * A template literal tag that creates an HTML <template> element from the\n * contents of the string.\n *\n * This allows you to write a Polymer Template in JavaScript.\n *\n * Templates can be composed by interpolating `HTMLTemplateElement`s in\n * expressions in the JavaScript template literal. The nested template's\n * `innerHTML` is included in the containing template.  The only other\n * values allowed in expressions are those returned from `htmlLiteral`\n * which ensures only literal values from JS source ever reach the HTML, to\n * guard against XSS risks.\n *\n * All other values are disallowed in expressions to help prevent XSS\n * attacks; however, `htmlLiteral` can be used to compose static\n * string values into templates. This is useful to compose strings into\n * places that do not accept html, like the css text of a `style`\n * element.\n *\n * Example:\n *\n *     static get template() {\n *       return html`\n *         <style>:host{ content:\"...\" }</style>\n *         <div class=\"shadowed\">${this.partialTemplate}</div>\n *         ${super.template}\n *       `;\n *     }\n *     static get partialTemplate() { return html`<span>Partial!</span>`; }\n *\n * @param {!ITemplateArray} strings Constant parts of tagged template literal\n * @param {...*} values Variable parts of tagged template literal\n * @return {!HTMLTemplateElement} Constructed HTMLTemplateElement\n */\nexport const html = function html(strings, ...values) {\n  const template = /** @type {!HTMLTemplateElement} */(document.createElement('template'));\n  template.innerHTML = values.reduce((acc, v, idx) =>\n      acc + htmlValue(v) + strings[idx + 1], strings[0]);\n  return template;\n};\n\n/**\n * An html literal tag that can be used with `html` to compose.\n * a literal string.\n *\n * Example:\n *\n *     static get template() {\n *       return html`\n *         <style>\n *           :host { display: block; }\n *           ${this.styleTemplate()}\n *         </style>\n *         <div class=\"shadowed\">${staticValue}</div>\n *         ${super.template}\n *       `;\n *     }\n *     static get styleTemplate() {\n *        return htmlLiteral`.shadowed { background: gray; }`;\n *     }\n *\n * @param {!ITemplateArray} strings Constant parts of tagged template literal\n * @param {...*} values Variable parts of tagged template literal\n * @return {!LiteralString} Constructed literal string\n */\nexport const htmlLiteral = function(strings, ...values) {\n  return new LiteralString(values.reduce((acc, v, idx) =>\n      acc + literalValue(v) + strings[idx + 1], strings[0]));\n};\n","// Polymer legacy event helpers used courtesy of the Polymer project.\n//\n// Copyright (c) 2017 The Polymer Authors. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are\n// met:\n//\n//    * Redistributions of source code must retain the above copyright\n// notice, this list of conditions and the following disclaimer.\n//    * Redistributions in binary form must reproduce the above\n// copyright notice, this list of conditions and the following disclaimer\n// in the documentation and/or other materials provided with the\n// distribution.\n//    * Neither the name of Google Inc. nor the names of its\n// contributors may be used to endorse or promote products derived from\n// this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n// \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\nexport default (superClass) => {\n  /**\n   * @extends HTMLElement\n   */\n  class EventsMixin extends superClass {\n    /**\n     * Dispatches a custom event with an optional detail value.\n     *\n     * @param {string} type Name of event type.\n     * @param {*=} detail Detail value containing event-specific\n     *   payload.\n     * @param {{ bubbles: (boolean|undefined),\n                 cancelable: (boolean|undefined),\n                 composed: (boolean|undefined) }=}\n     *  options Object specifying options.  These may include:\n     *  `bubbles` (boolean, defaults to `true`),\n     *  `cancelable` (boolean, defaults to false), and\n     *  `node` on which to fire the event (HTMLElement, defaults to `this`).\n     * @return {Event} The new event that was fired.\n     */\n    fire(type, detail = {}, options = {}) {\n      const event = new Event(type, {\n        bubbles: options.bubbles === undefined ? true : options.bubbles,\n        cancelable: Boolean(options.cancelable),\n        composed: options.composed === undefined ? true : options.composed,\n      });\n      event.detail = detail;\n      const node = options.node || this;\n      node.dispatchEvent(event);\n      return event;\n    }\n  }\n  return EventsMixin;\n};\n","import { html } from '@polymer/polymer/lib/utils/html-tag.js';\nimport EventsMixin from '../mixins/events-mixin.js';\nimport '../utils/hooks.js';\n\n/**\n * @extends HTMLElement\n */\nclass HaConfigCustomUi extends EventsMixin(Polymer.Element) {\n  static get template() {\n    return html`\n    <style include=\"ha-style\"></style>\n    <app-header-layout has-scrolling-region>\n      <app-header slot=\"header\" fixed>\n        <app-toolbar>\n          <paper-icon-button\n            icon='mdi:arrow-left'\n            on-click='_backHandler'\n          ></paper-icon-button>\n          <div main-title>Custom UI settings</div>\n        </app-toolbar>\n      </app-header>\n\n      <ha-config-section is-wide='[[isWide]]'>\n        <paper-card heading='Device name'>\n          <div class='card-content'>\n            Set device name so that you can reference it in per-device settings\n            <paper-input\n              label='Name'\n              value='{{name}}'\n            ></paper-input>\n          </div>\n        </paper-card>\n      </ha-config-section>\n    </app-header-layout>\n    `;\n  }\n\n  static get properties() {\n    return {\n      isWide: Boolean,\n\n      name: {\n        type: String,\n        observer: 'nameChanged',\n      },\n    };\n  }\n\n  ready() {\n    super.ready();\n    this.name = window.customUI.getName();\n  }\n\n  nameChanged(name) {\n    window.customUI.setName(name);\n  }\n\n  _backHandler() {\n    window.history.back();\n    this.fire('location-changed');\n  }\n}\ncustomElements.define('ha-config-custom-ui', HaConfigCustomUi);\n","import applyThemesOnElement from '../../home-assistant-polymer/src/common/dom/apply_themes_on_element.js';\nimport computeStateDomain from '../../home-assistant-polymer/src/common/entity/compute_state_domain.js';\nimport getViewEntities from '../../home-assistant-polymer/src/common/entity/get_view_entities.js';\n\nimport '../elements/ha-config-custom-ui.js';\nimport VERSION from './version.js';\n\nwindow.customUI = window.customUI || {\n  SUPPORTED_SLIDER_MODES: [\n    'single-line', 'break-slider', 'break-slider-toggle', 'hide-slider', 'no-slider',\n  ],\n\n  domHost(elem) {\n    if (elem === document) return null;\n    const root = elem.getRootNode();\n    return (root instanceof DocumentFragment) ? /** @type {ShadowRoot} */ (root).host : root;\n  },\n\n  lightOrShadow(elem, selector) {\n    return elem.shadowRoot ?\n      elem.shadowRoot.querySelector(selector) :\n      elem.querySelector(selector);\n  },\n\n  getElementHierarchy(root, hierarchy) {\n    if (root === null) return null;\n    const elem = hierarchy.shift();\n    if (elem) {\n      return window.customUI.getElementHierarchy(\n        window.customUI.lightOrShadow(root, elem), hierarchy);\n    }\n    return root;\n  },\n\n  getContext(elem) {\n    if (elem._context === undefined) {\n      elem._context = [];\n      for (let element = (elem.tagName === 'HA-ENTITIES-CARD' ? window.customUI.domHost(elem) : elem);\n        element; element = window.customUI.domHost(element)) {\n        switch (element.tagName) {\n          case 'HA-ENTITIES-CARD':\n            if (element.groupEntity) {\n              elem._context.push(element.groupEntity.entity_id);\n            } else if (element.groupEntity === false && element.states && element.states.length) {\n              elem._context.push(`group.${computeStateDomain(element.states[0])}`);\n            }\n            break;\n          case 'MORE-INFO-GROUP':\n          case 'STATE-CARD-CONTENT':\n            if (element.stateObj) {\n              elem._context.push(element.stateObj.entity_id);\n            }\n            break;\n          case 'HA-CARDS':\n            elem._context.push(element.getAttribute('data-view') || 'default_view');\n            break;\n          // no default\n        }\n      }\n      elem._context.reverse();\n    }\n    return elem._context;\n  },\n\n  findMatch(key, options) {\n    if (!options) return null;\n    if (options[key]) return key;\n    return Object.keys(options).find(option => key.match(`^${option}$`));\n  },\n\n  maybeChangeObjectByDevice(stateObj) {\n    const name = window.customUI.getName();\n    if (!name) return stateObj;\n    const match = this.findMatch(name, stateObj.attributes.device);\n    if (!match) return stateObj;\n    const attributes = Object.assign({}, stateObj.attributes.device[match]);\n\n    if (!Object.keys(attributes).length) return stateObj;\n    return window.customUI.applyAttributes(stateObj, attributes);\n  },\n\n  maybeChangeObjectByGroup(elem, stateObj) {\n    const context = window.customUI.getContext(elem);\n    if (!context) return stateObj;\n\n    if (!stateObj.attributes.group) {\n      return stateObj;\n    }\n    const attributes = {};\n    context.forEach((c) => {\n      const match = this.findMatch(c, stateObj.attributes.group);\n      if (stateObj.attributes.group[match]) {\n        Object.assign(attributes, stateObj.attributes.group[match]);\n      }\n    });\n\n    if (!Object.keys(attributes).length) return stateObj;\n\n    return window.customUI.applyAttributes(stateObj, attributes);\n  },\n\n  _setKeep(obj, value) {\n    if (obj._cui_keep === undefined) {\n      obj._cui_keep = value;\n    } else {\n      obj._cui_keep = obj._cui_keep && value;\n    }\n  },\n\n  maybeApplyTemplateAttributes(hass, states, stateObj, attributes) {\n    if (!attributes.templates) {\n      window.customUI._setKeep(stateObj, true);\n      return stateObj;\n    }\n    const newAttributes = {};\n    let hasGlobal = false;\n    let hasChanges = false;\n    Object.keys(attributes.templates).forEach((key) => {\n      const template = attributes.templates[key];\n      if (template.match(/\\b(entities|hass)\\b/)) {\n        hasGlobal = true;\n      }\n      const value = window.customUI.computeTemplate(\n        template, hass, states, stateObj, attributes,\n        (stateObj.untemplated_attributes && stateObj.untemplated_attributes[key]) ||\n            attributes[key],\n        stateObj.untemplated_state || stateObj.state);\n      // In case of null don't set the value.\n      if (value === null) return;\n      newAttributes[key] = value;\n      if (key === 'state') {\n        if (value !== stateObj.state) {\n          hasChanges = true;\n        }\n      } else if (key === '_stateDisplay') {\n        if (value !== stateObj._stateDisplay) {\n          hasChanges = true;\n        }\n      } else if (value !== attributes[key]) {\n        hasChanges = true;\n      }\n    });\n    window.customUI._setKeep(stateObj, !hasGlobal);\n    if (!hasChanges) {\n      return stateObj;\n    }\n    if (stateObj.attributes === attributes) {\n      // We are operating on real attributes. Replace them.\n      const result = window.customUI.applyAttributes(stateObj, newAttributes);\n      if (Object.prototype.hasOwnProperty.call(newAttributes, 'state')) {\n        if (newAttributes.state !== null) {\n          result.state = String(newAttributes.state);\n          result.untemplated_state = stateObj.state;\n        }\n      }\n      if (Object.prototype.hasOwnProperty.call(newAttributes, '_stateDisplay')) {\n        result._stateDisplay = newAttributes._stateDisplay;\n        result.untemplated_stateDisplay = stateObj._stateDisplay;\n      }\n      window.customUI._setKeep(result, !hasGlobal);\n      return result;\n    }\n    // Operating on context-aware attributes. Return shallow copy of object.\n    return Object.assign({}, stateObj);\n  },\n\n  maybeApplyTemplates(hass, states, stateObj) {\n    const newResult = window.customUI.maybeApplyTemplateAttributes(\n      hass, states, stateObj, stateObj.attributes);\n    let hasChanges = (newResult !== stateObj);\n\n    function checkAttributes(obj) {\n      if (!obj) return;\n      Object.values(obj).forEach((attributes) => {\n        const result = window.customUI.maybeApplyTemplateAttributes(\n          hass, states, newResult, attributes);\n        hasChanges |= (result !== newResult);\n      });\n      checkAttributes(obj.device);\n      checkAttributes(obj.group);\n    }\n\n    checkAttributes(stateObj.attributes.device);\n    checkAttributes(stateObj.attributes.group);\n    if (newResult !== stateObj) return newResult;\n    if (hasChanges) {\n      return Object.assign({}, stateObj);\n    }\n    return stateObj;\n  },\n\n  applyAttributes(stateObj, attributes) {\n    return {\n      entity_id: stateObj.entity_id,\n      state: stateObj.state,\n      attributes: Object.assign({}, stateObj.attributes, attributes),\n      untemplated_attributes: stateObj.attributes,\n      last_changed: stateObj.last_changed,\n    };\n  },\n\n  maybeChangeObject(elem, stateObj, inDialog, allowHidden) {\n    if (inDialog) return stateObj;\n    let obj = window.customUI.maybeChangeObjectByDevice(stateObj);\n    obj = window.customUI.maybeChangeObjectByGroup(elem, obj);\n    obj = window.customUI.maybeApplyTemplateAttributes(\n      elem.hass, elem.hass.states, obj, obj.attributes);\n\n    if (obj !== stateObj && obj.attributes.hidden && allowHidden) {\n      return null;\n    }\n    return obj;\n  },\n\n  fixGroupTitles() {\n    const homeAssistantMain = window.customUI.getElementHierarchy(document, [\n      'home-assistant',\n      'home-assistant-main']);\n    if (homeAssistantMain === null) {\n      // DOM not ready. Wait 1 second.\n      window.setTimeout(window.customUI.fixGroupTitles, 1000);\n      return;\n    }\n\n    const haCards = window.customUI.getElementHierarchy(homeAssistantMain, [\n      'partial-cards',\n      'ha-cards[view-visible]']);\n    if (haCards === null) return;\n    const main = window.customUI.lightOrShadow(haCards, '.main') || haCards.$.main;\n    const cards = main.querySelectorAll('ha-entities-card');\n    cards.forEach((card) => {\n      if (card.groupEntity) {\n        const obj = window.customUI.maybeChangeObject(\n          card,\n          card.groupEntity,\n          false /* inDialog */,\n          false /* allowHidden */);\n        if (obj !== card.groupEntity && obj.attributes.friendly_name) {\n          const nameElem = window.customUI.lightOrShadow(card, '.name');\n          nameElem.textContent = obj.attributes.friendly_name;\n        }\n      }\n    });\n  },\n\n  controlColumns(columns) {\n    const partialCards = window.customUI.getElementHierarchy(document, [\n      'home-assistant',\n      'home-assistant-main',\n      'partial-cards']);\n    if (partialCards === null) {\n      // DOM not ready. Wait 1 second.\n      window.setTimeout(\n        window.customUI.controlColumns.bind(null, columns),\n        1000);\n      return;\n    }\n    partialCards.mqls.forEach((mql) => {\n      mql.removeListener(partialCards.handleWindowChange);\n    });\n    partialCards.mqls = columns.map((width) => {\n      const mql = window.matchMedia(`(min-width: ${width}px)`);\n      mql.addListener(partialCards.handleWindowChange);\n      return mql;\n    });\n    partialCards.handleWindowChange();\n  },\n\n  useCustomizer() {\n    const main = window.customUI.lightOrShadow(document, 'home-assistant');\n    const customizer = main.hass.states['customizer.customizer'];\n    if (!customizer) return;\n    if (customizer.attributes.columns) {\n      window.customUI.controlColumns(customizer.attributes.columns);\n    }\n    if (customizer.attributes.hide_attributes) {\n      // TODO: Won't working starting from HA 0.71\n      if (window.hassAttributeUtil && window.hassAttributeUtil.LOGIC_STATE_ATTRIBUTES) {\n        customizer.attributes.hide_attributes.forEach((attr) => {\n          if (!Object.prototype.hasOwnProperty.call(\n            window.hassAttributeUtil.LOGIC_STATE_ATTRIBUTES, attr)) {\n            window.hassAttributeUtil.LOGIC_STATE_ATTRIBUTES[attr] = undefined;\n          }\n        });\n      }\n    }\n  },\n\n  updateAttributes() {\n    if (!window.hassAttributeUtil) {\n      // App.js wasn't parsed yet.\n      window.setTimeout(window.customUI.updateAttributes, 1000);\n      return;\n    }\n\n    const customUiAttributes = {\n      group: undefined,\n      device: undefined,\n      templates: undefined,\n      state_card_mode: {\n        type: 'array',\n        options: {\n          light: window.customUI.SUPPORTED_SLIDER_MODES.concat('badges'),\n          cover: window.customUI.SUPPORTED_SLIDER_MODES.concat('badges'),\n          '*': ['badges'],\n        },\n      },\n      state_card_custom_ui_secondary: { type: 'string' },\n      badges_list: { type: 'json' },\n      show_last_changed: { type: 'boolean' },\n      hide_control: { type: 'boolean' },\n      extra_data_template: { type: 'string' },\n      extra_badge: { type: 'json' },\n      stretch_slider: { type: 'boolean' },\n      slider_theme: { type: 'json' },\n      theme: { type: 'string' },\n      confirm_controls: { type: 'boolean' },\n      confirm_controls_show_lock: { type: 'boolean' },\n      hide_in_default_view: { type: 'boolean' },\n    };\n    if (window.hassAttributeUtil.LOGIC_STATE_ATTRIBUTES) {\n      Object.assign(window.hassAttributeUtil.LOGIC_STATE_ATTRIBUTES, customUiAttributes);\n    }\n  },\n\n  updateConfigPanel() {\n    if (!window.location.pathname.startsWith('/config')) return;\n    const haPanelConfig = window.customUI.getElementHierarchy(document, [\n      'home-assistant',\n      'home-assistant-main',\n      'partial-panel-resolver',\n      'ha-panel-config']);\n    if (!haPanelConfig) {\n      // DOM not ready. Wait 100ms.\n      window.setTimeout(window.customUI.updateConfigPanel, 100);\n      return;\n    }\n    const haConfigNavigation = window.customUI.getElementHierarchy(haPanelConfig, [\n      'ha-config-dashboard',\n      'ha-config-navigation']);\n    if (haConfigNavigation) {\n      // HaConfigNavigation started using localize on 21.01.2018\n      if (haConfigNavigation.localize && !haConfigNavigation.cuiPatch) {\n        haConfigNavigation.cuiPatch = true;\n        haConfigNavigation._originalComputeLoaded = haConfigNavigation._computeLoaded;\n        haConfigNavigation._originalComputeCaption = haConfigNavigation._computeCaption;\n        haConfigNavigation._originalComputeDescription = haConfigNavigation._computeDescription;\n        haConfigNavigation._computeLoaded = (hass, page) =>\n          page === 'customui' || haConfigNavigation._originalComputeLoaded(hass, page);\n        haConfigNavigation._computeCaption = (page, localize) =>\n          (page === 'customui' ? 'Custom UI' : haConfigNavigation._originalComputeCaption(page, localize));\n        haConfigNavigation._computeDescription = (page, localize) =>\n          (page === 'customui' ? 'SetUI tweaks' : haConfigNavigation._originalComputeDescription(page, localize));\n      }\n      if (!haConfigNavigation.pages.some(conf => conf === 'customui' || conf.domain === 'customui')) {\n        haConfigNavigation.push('pages', haConfigNavigation.localize ? 'customui' : {\n          domain: 'customui',\n          caption: 'Custom UI',\n          description: 'Set UI tweaks.',\n          loaded: true,\n        });\n      }\n    }\n    const getHaConfigCustomUi = () => {\n      const haConfigCustomUi = document.createElement('ha-config-custom-ui');\n      haConfigCustomUi.isWide = haPanelConfig.isWide;\n      haConfigCustomUi.setAttribute('page-name', 'customui');\n      return haConfigCustomUi;\n    };\n\n    const ironPages = window.customUI.lightOrShadow(haPanelConfig, 'iron-pages');\n    if (ironPages) {\n      if (ironPages.lastElementChild.tagName !== 'HA-CONFIG-CUSTOM-UI') {\n        const haConfigCustomUi = getHaConfigCustomUi();\n        ironPages.appendChild(haConfigCustomUi);\n        ironPages.addEventListener('iron-items-changed', () => {\n          if (window.location.pathname.startsWith('/config/customui')) {\n            ironPages.select('customui');\n          }\n        });\n      }\n    } else {\n      const root = haPanelConfig.shadowRoot || haPanelConfig;\n      if (root.lastElementChild.tagName !== 'HA-CONFIG-CUSTOM-UI') {\n        const haConfigCustomUi = getHaConfigCustomUi();\n        root.appendChild(haConfigCustomUi);\n      }\n      const visible = window.location.pathname.startsWith('/config/customui');\n      root.lastElementChild.style.display = visible ? '' : 'none';\n    }\n  },\n\n  installStatesHook() {\n    const homeAssistant = customElements.get('home-assistant');\n    if (!homeAssistant || !homeAssistant.prototype._updateHass) return;\n    const originalUpdate = homeAssistant.prototype._updateHass;\n    homeAssistant.prototype._updateHass = function update(obj) {\n      // Use named function to preserve 'this'.\n      const { hass } = this;\n      if (obj.states) {\n        Object.keys(obj.states).forEach((key) => {\n          const entity = obj.states[key];\n          if (entity._cui_keep) return;\n          const newEntity = window.customUI.maybeApplyTemplates(hass, obj.states, entity);\n          if (hass.states && entity !== hass.states[key]) {\n            // New state arrived. Put modified state in.\n            obj.states[key] = newEntity;\n          } else if (entity !== newEntity) {\n            // It's the same state but contents changed due to other state changes.\n            obj.states[key] = newEntity;\n          }\n        });\n      }\n      originalUpdate.call(this, obj);\n      if (obj.themes && hass._themeWaiters) {\n        hass._themeWaiters.forEach(waiter => waiter.stateChanged(waiter.state));\n        hass._themeWaiters = undefined;\n      }\n    };\n    const main = window.customUI.lightOrShadow(document, 'home-assistant');\n    if (main.hass && main.hass.states) {\n      main._updateHass({ states: main.hass.states });\n    }\n  },\n\n  installPartialCards() {\n    const partialCards = customElements.get('partial-cards');\n    if (!partialCards || !partialCards.prototype._defaultViewFilter) return;\n    partialCards.prototype._defaultViewFilter = (hass, entityId) => {\n      if (hass.states[entityId].attributes.hidden) return false;\n      const excludes = {};\n      Object.values(hass.states).forEach((entity) => {\n        if (entity.attributes && entity.attributes.hide_in_default_view) {\n          const excludeEntityId = entity.entity_id;\n          if (excludes[excludeEntityId]) return;\n          excludes[excludeEntityId] = entity;\n          if (entity.attributes.view) {\n            Object.assign(\n              excludes, getViewEntities(hass.states, entity));\n          }\n        }\n      });\n      return !excludes[entityId];\n    };\n  },\n\n  // Allows changing the 'Execute' / 'Activate' text on script/scene cards.\n  installActionName(elementName) {\n    const klass = customElements.get(elementName);\n    if (!klass || !klass.prototype) return;\n    Object.defineProperty(klass.prototype, 'localize', {\n      get() {\n        function customLocalize(v) {\n          if (this.stateObj && this.stateObj.attributes &&\n              this.stateObj.attributes.action_name) {\n            return this.stateObj.attributes.action_name;\n          }\n          return this.__data.localize(v);\n        }\n        return customLocalize;\n      },\n      set() {},\n    });\n  },\n\n  // Allows theming \"regular\" top badges.\n  installHaStateLabelBadge() {\n    const haStateLabelBadge = customElements.get('ha-state-label-badge');\n    if (!haStateLabelBadge || !haStateLabelBadge.prototype.stateChanged) return;\n    // Use named function to preserve 'this'.\n    haStateLabelBadge.prototype.stateChanged = function update(stateObj) {\n      // TODO: Call window.customUI.maybeChangeObject\n      if (stateObj.attributes.theme) {\n        if (this.hass.themes === null) {\n          this.hass._themeWaiters = this.hass._themeWaiters || [];\n          this.hass._themeWaiters.push(this);\n        } else {\n          applyThemesOnElement(\n            this,\n            this.hass.themes || { default_theme: 'default', themes: {} },\n            stateObj.attributes.theme || 'default');\n        }\n      }\n      this.updateStyles();\n      if (this.startInterval) {\n        // Added on 19.1.2018\n        this.startInterval(stateObj);\n      }\n    };\n  },\n\n  installStateBadge() {\n    const stateBadge = customElements.get('state-badge');\n    if (!stateBadge || !stateBadge.prototype.updateIconAppearance) return;\n    const originalUpdateIconAppearance = stateBadge.prototype.updateIconAppearance;\n    // Use named function to preserve 'this'.\n    stateBadge.prototype.updateIconAppearance = function customUpdateIconAppearance(stateObj) {\n      if (stateObj.attributes.icon_color && !stateObj.attributes.entity_picture) {\n        this.style.backgroundImage = '';\n        Object.assign(this.$.icon.style, {\n          display: 'inline',\n          color: stateObj.attributes.icon_color,\n          filter: '',\n        });\n      } else {\n        originalUpdateIconAppearance.call(this, stateObj);\n      }\n    };\n  },\n\n  installClassHooks() {\n    if (window.customUI.classInitDone) return;\n    window.customUI.classInitDone = true;\n    window.customUI.installPartialCards();\n    window.customUI.installStatesHook();\n    window.customUI.installHaStateLabelBadge();\n    window.customUI.installStateBadge();\n    window.customUI.installActionName('state-card-scene');\n    window.customUI.installActionName('state-card-script');\n    // TODO: Fix, not working since HA 0.71\n    window.customUI.updateAttributes();\n  },\n\n  init() {\n    if (window.customUI.initDone) return;\n    window.customUI.installClassHooks();\n    const main = window.customUI.lightOrShadow(document, 'home-assistant');\n    if (!main.hass || !main.hass.states) {\n      // Connection wasn't made yet. Try in 1 second.\n      window.setTimeout(window.customUI.init, 1000);\n      return;\n    }\n    window.customUI.initDone = true;\n\n    window.customUI.useCustomizer();\n\n    window.customUI.runHooks();\n    window.addEventListener('location-changed', window.setTimeout.bind(null, window.customUI.runHooks, 100));\n    /* eslint-disable no-console */\n    console.log(`Loaded CustomUI ${VERSION}`);\n    /* eslint-enable no-console */\n    if (!window.CUSTOM_UI_LIST) {\n      window.CUSTOM_UI_LIST = [];\n    }\n    window.CUSTOM_UI_LIST.push({\n      name: 'CustomUI',\n      version: VERSION,\n      url: 'https://github.com/andrey-git/home-assistant-custom-ui',\n    });\n  },\n\n  runHooks() {\n    window.customUI.fixGroupTitles();\n    window.customUI.updateConfigPanel();\n  },\n\n  getName() {\n    return window.localStorage.getItem('ha-device-name') || '';\n  },\n\n  setName(name) {\n    window.localStorage.setItem('ha-device-name', name || '');\n  },\n\n  computeTemplate(template, hass, entities, entity, attributes, attribute, state) {\n    const functionBody = (template.indexOf('return') >= 0) ? template : `return \\`${template}\\`;`;\n    try {\n      /* eslint-disable no-new-func */\n      const func = new Function(\n        'hass', 'entities', 'entity', 'attributes', 'attribute', 'state', functionBody);\n      /* eslint-enable no-new-func */\n      return func(hass, entities, entity, attributes, attribute, state);\n    } catch (e) {\n      /* eslint-disable no-console */\n      if ((e instanceof SyntaxError) || e instanceof ReferenceError) {\n        console.warn(`${e.name}: ${e.message} in template ${functionBody}`);\n        return null;\n      }\n      /* eslint-enable no-console */\n      throw e;\n    }\n  },\n};\nwindow.customUI.init();\n","import computeDomain from './compute_domain.js';\nimport getGroupEntities from './get_group_entities.js';\n\n// Return an object containing all entities that the view will show\n// including embedded groups.\nexport default function getViewEntities(entities, view) {\n  const viewEntities = {};\n\n  view.attributes.entity_id.forEach((entityId) => {\n    const entity = entities[entityId];\n\n    if (entity && !entity.attributes.hidden) {\n      viewEntities[entity.entity_id] = entity;\n\n      if (computeDomain(entity.entity_id) === 'group') {\n        const groupEntities = getGroupEntities(entities, entity);\n\n        Object.keys(groupEntities).forEach((grEntityId) => {\n          const grEntity = groupEntities[grEntityId];\n\n          if (!grEntity.attributes.hidden) {\n            viewEntities[grEntityId] = grEntity;\n          }\n        });\n      }\n    }\n  });\n\n  return viewEntities;\n}\n","export default function getGroupEntities(entities, group) {\n  const result = {};\n\n  group.attributes.entity_id.forEach((entityId) => {\n    const entity = entities[entityId];\n\n    if (entity) {\n      result[entity.entity_id] = entity;\n    }\n  });\n\n  return result;\n}\n","export default '20180521';\n","import '../utils/hooks.js';\n\n/**\n * @extends HTMLElement\n */\nclass CuiBaseElement extends Polymer.Element {\n  static get properties() {\n    return {\n      hass: Object,\n      inDialog: {\n        type: Boolean,\n        value: false,\n      },\n      stateObj: Object,\n      controlElement: String,\n      extra: {\n        type: Array,\n        computed: 'computeExtra(hass, stateObj)',\n      },\n    };\n  }\n\n  computeExtra(hass, stateObj) {\n    let extras = stateObj.attributes.extra_data_template;\n    if (extras) {\n      if (!Array.isArray(extras)) {\n        extras = [extras];\n      }\n      return extras.map(extra => window.customUI.computeTemplate(\n        extra,\n        hass,\n        hass.states,\n        stateObj,\n        stateObj.attributes,\n        /* attribute= */ undefined,\n        stateObj.state,\n      )).filter(result => result !== null);\n    }\n    return [];\n  }\n\n  showLastChanged(stateObj, inDialog, extra) {\n    if (inDialog) return true;\n    if (extra.length) return false;\n    return !!stateObj.attributes.show_last_changed;\n  }\n\n  hasExtra(extra) {\n    return extra.length > 0;\n  }\n}\nexport default CuiBaseElement;\n","import dynamicContentUpdater from '../../home-assistant-polymer/src/common/dom/dynamic_content_updater.js';\n\n/**\n * @extends HTMLElement\n */\nclass DynamicElement extends Polymer.Element {\n  static get properties() {\n    return {\n      hass: Object,\n      stateObj: Object,\n      elementName: String,\n\n      inDialog: {\n        type: Boolean,\n        value: false,\n      },\n    };\n  }\n\n  static get observers() {\n    return [\n      'observerFunc(hass, stateObj, elementName, inDialog)',\n    ];\n  }\n\n  observerFunc(hass, stateObj, elementName, inDialog) {\n    dynamicContentUpdater(\n      this,\n      elementName ? elementName.toUpperCase() : 'DIV',\n      { hass, stateObj, inDialog });\n  }\n}\ncustomElements.define('dynamic-element', DynamicElement);\n","import { html } from '@polymer/polymer/lib/utils/html-tag.js';\nimport applyThemesOnElement from '../../home-assistant-polymer/src/common/dom/apply_themes_on_element.js';\n\nimport './dynamic-element.js';\nimport '../utils/hooks.js';\n\n/**\n * @extends HTMLElement\n */\nclass DynamicWithExtra extends customElements.get('state-card-display') {\n  static get template() {\n    return html`\n    <style is=\"custom-style\" include=\"iron-flex iron-flex-alignment iron-flex-factors\"></style>\n    <style>\n      :host {\n        display: inline-block;\n      }\n      .control-wrapper {\n        margin: -4px -16px -4px 0;\n        padding: 4px 16px;\n      }\n      ha-state-label-badge {\n        margin-left: 8px;\n      }\n      dynamic-element {\n        display: block;\n        text-align: right;\n      }\n      #overlay {\n        position: absolute;\n        left: 0;\n        right: 0;\n        top: 0;\n        bottom: 0;\n        text-align: right;\n        z-index: 1;\n      }\n      #lock {\n        margin-top: 8px;\n        opacity: 0.3;\n        margin-right: 7px;\n      }\n      #lock.ha-cover-controls {\n        margin-right: 52px;\n        background-color: white;\n      }\n      .extra {\n        margin-bottom: -16px;\n        --ha-label-badge-size: 36px;\n        --ha-label-badge-font-size: 1.2em;\n      }\n      .state {\n        @apply --paper-font-body1;\n        color: var(--primary-text-color);\n        margin-left: 16px;\n        text-align: right;\n        line-height: 40px;\n      }\n    </style>\n    <div class$='[[extraClass(extraObjVisible)]] horizontal layout'>\n      <template is='dom-if' if='[[extraObjVisible]]'>\n        <template is='dom-repeat'\n                  items='[[extraObj]]'\n                  on-dom-change='extraDomChanged'>\n          <ha-state-label-badge hass='[[hass]]' state='[[item]]'></ha-state-label-badge>\n        </template>\n      </template>\n      <template is='dom-if' if='[[_showControl(inDialog, stateObj)]]'>\n        <template is='dom-if' if='[[controlElement]]'>\n          <div class=\"control-wrapper\">\n            <dynamic-element\n                class='flex'\n                state-obj=\"[[stateObj]]\"\n                hass='[[hass]]'\n                element-name='[[controlElement]]'>\n            </dynamic-element>\n            <template is='dom-if' if='[[isConfirmControls(stateObj)]]'>\n              <div id=\"overlay\" on-click='clickHandler'>\n                <template is='dom-if' if='[[stateObj.attributes.confirm_controls_show_lock]]'>\n                  <iron-icon id=\"lock\" class$=\"[[controlElement]]\" icon=\"mdi:lock-outline\"></iron-icon>\n                </template>\n              </div>\n            </template>\n          </div>\n        </template>\n        <template is='dom-if' if='[[!controlElement]]'>\n          <div class='state'>[[computeStateDisplay(stateObj)]]</div>\n        </template>\n      </template>\n    </div>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: Object,\n      inDialog: {\n        type: Boolean,\n        value: false,\n      },\n      stateObj: Object,\n      controlElement: String,\n      extraObj: {\n        type: Array,\n        computed: 'computeExtra(hass, stateObj, _attached)',\n      },\n      _attached: Boolean,\n      extraObjVisible: {\n        type: Boolean,\n        computed: 'computeExtraVisible(extraObj, inDialog)',\n      },\n    };\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    this._attached = true;\n  }\n\n  disconnectedCallback() {\n    this._isAttached = false;\n    super.disconnectedCallback();\n  }\n\n  computeExtra(hass, stateObj, attached) {\n    if (!stateObj.attributes.extra_badge || !attached) return [];\n    let extraBadges = stateObj.attributes.extra_badge;\n    if (!Array.isArray(extraBadges)) {\n      extraBadges = [extraBadges];\n    }\n    return extraBadges.map((extraBadge) => {\n      let result = null;\n      if (extraBadge.entity_id && hass.states[extraBadge.entity_id]) {\n        result = Object.assign({}, window.customUI.maybeChangeObject(\n          this, hass.states[extraBadge.entity_id], this.inDialog,\n          /* allowHidden= */false));\n      } else if (extraBadge.attribute &&\n                 stateObj.attributes[extraBadge.attribute] !== undefined) {\n        result = {\n          state: String(stateObj.attributes[extraBadge.attribute]),\n          _domain: 'none',\n          entity_id: null,\n          attributes: { unit_of_measurement: extraBadge.unit },\n        };\n      }\n      if (!result) return null;\n      let blacklist = extraBadge.blacklist_states;\n      if (blacklist !== undefined) {\n        if (!Array.isArray(blacklist)) {\n          blacklist = [blacklist];\n        }\n        if (blacklist.some(v => RegExp(v).test(result.state.toString()))) {\n          return null;\n        }\n      }\n      result._entityDisplay = '';\n      return result;\n    }).filter(extraBadge => extraBadge != null);\n  }\n\n  computeExtraVisible(extraObj, inDialog) {\n    if (inDialog || !extraObj) return false;\n    return extraObj.length !== 0;\n  }\n\n  extraClass(extraObjVisible) {\n    return extraObjVisible ? 'extra' : '';\n  }\n\n  _showControl(inDialog, stateObj) {\n    if (inDialog) return true;\n    return !stateObj.attributes.hide_control;\n  }\n\n  computeStateDisplay(stateObj) {\n    // haLocalize removed in 0.61\n    return super.computeStateDisplay(this.haLocalize || this.localize, stateObj);\n  }\n\n  isConfirmControls(stateObj) {\n    return stateObj.attributes.confirm_controls ||\n        stateObj.attributes.confirm_controls_show_lock;\n  }\n\n  clickHandler(e) {\n    this.root.querySelector('#overlay').style.pointerEvents = 'none';\n    const lock = this.root.querySelector('#lock');\n    if (lock) {\n      lock.icon = 'mdi:lock-open-outline';\n      lock.style.opacity = '0.1';\n    }\n    window.setTimeout(() => {\n      this.root.querySelector('#overlay').style.pointerEvents = '';\n      if (lock) {\n        lock.icon = 'mdi:lock-outline';\n        lock.style.opacity = '';\n      }\n    }, 5000);\n    e.stopPropagation();\n  }\n\n  applyThemes(hass, element, stateObj) {\n    const themeName = stateObj.attributes.theme || 'default';\n    applyThemesOnElement(\n      element, hass.themes || { default_theme: 'default', themes: {} }, themeName);\n  }\n\n  extraDomChanged() {\n    this.root.querySelectorAll('ha-state-label-badge')\n      .forEach((elem) => {\n        this.applyThemes(this.hass, elem, elem.state);\n      });\n  }\n}\ncustomElements.define('dynamic-with-extra', DynamicWithExtra);\n","import { html } from '@polymer/polymer/lib/utils/html-tag.js';\n\n/**\n * @extends HTMLElement\n */\nclass HaThemedSlider extends Polymer.Element {\n  static get template() {\n    return html`\n    <style>\n      :host {\n        margin: var(--ha-themed-slider-margin, initial);\n      }\n      .disable-off-when-min {\n        --paper-slider-pin-start-color:  var(--paper-slider-pin-color);\n      }\n\n      .disable-off-when-min.is-on {\n        --paper-slider-knob-start-color: var(--paper-slider-knob-color);\n        --paper-slider-knob-start-border-color: var(--paper-slider-knob-color);\n      }\n      paper-slider {\n        margin: 4px 0;\n        max-width: 100%;\n        min-width: 100px;\n        width: var(--ha-paper-slider-width, 200px);\n      }\n    </style>\n\n    <paper-slider\n         min='[[_themedMin]]'\n         max='[[_computeAttribute(theme, \"max\", max)]]'\n         pin='[[_computeAttribute(theme, \"pin\", pin)]]'\n         class$='[[computeClass(theme, isOn, _themedMin)]]' value='[[value]]'\n         on-change='valueChanged'>\n    </paper-slider>\n    `;\n  }\n\n  ready() {\n    super.ready();\n    this.disableOffWhenMin = !this._computeAttribute(this.theme, 'off_when_min', !this.disableOffWhenMin);\n    this.computeEnabledThemedReportWhenNotChanged(this.theme, this.disableReportWhenNotChanged);\n  }\n\n  static get properties() {\n    return {\n      min: {\n        type: Number,\n        value: 0,\n      },\n      max: {\n        type: Number,\n        value: 100,\n      },\n      pin: {\n        type: Boolean,\n        value: false,\n      },\n      isOn: {\n        type: Boolean,\n        value: false,\n      },\n      disableOffWhenMin: {\n        type: Boolean,\n        value: false,\n        notify: true,\n      },\n      disableReportWhenNotChanged: {\n        type: Boolean,\n        value: false,\n      },\n\n      theme: Object,\n      value: {\n        type: Number,\n        notify: true,\n      },\n      _themedMin: {\n        type: Number,\n        computed: '_computeAttribute(theme, \"min\", min)',\n      },\n    };\n  }\n\n  static get observers() {\n    return [\n      'computeEnabledThemedReportWhenNotChanged(theme, disableReportWhenNotChanged)',\n    ];\n  }\n\n  computeEnabledThemedReportWhenNotChanged(theme, disableReportWhenNotChanged) {\n    this._enabledThemedReportWhenNotChanged = this._computeAttribute(\n      theme, 'report_when_not_changed', !disableReportWhenNotChanged);\n  }\n\n  _computeAttribute(theme, attr, def) {\n    if (theme) {\n      if (attr in theme) {\n        return theme[attr];\n      }\n    }\n    return def;\n  }\n\n  computeClass(theme, isOn, themedMin) {\n    let result = '';\n    if (isOn) {\n      result += 'is-on ';\n    }\n    if (this._computeAttribute(theme, 'off_when_min', !this.disableOffWhenMin) || themedMin === 0) {\n      // If offWhenMin is enabled don't customize.\n      return '';\n    }\n    return `${result}disable-off-when-min`;\n  }\n\n  valueChanged(ev) {\n    if (!this._enabledThemedReportWhenNotChanged && this.value === ev.target.value) {\n      ev.stopPropagation();\n      return;\n    }\n    this.value = ev.target.value;\n  }\n}\ncustomElements.define('ha-themed-slider', HaThemedSlider);\n","import { html } from '@polymer/polymer/lib/utils/html-tag.js';\nimport CuiBaseElement from './cui-base-element.js';\nimport './dynamic-with-extra.js';\nimport './ha-themed-slider.js';\n\n/**\n * @extends HTMLElement\n */\nclass StateCardWithSlider extends CuiBaseElement {\n  static get template() {\n    return html`\n    <style is=\"custom-style\" include=\"iron-flex iron-flex-alignment iron-flex-factors\"></style>\n    <style>\n      #container {\n        position: relative;\n      }\n      .second-line, .state-and-toggle, .state-info {\n        max-width: 100%;\n      }\n      .nowrap .state-and-toggle {\n        overflow: hidden;\n        flex-grow: 0;\n      }\n      .nowrap .second-line {\n        overflow: hidden;\n      }\n\n      .second-line {\n        padding-top: 20px;\n        padding-bottom: 16px;\n        margin-top: -20px;\n        margin-bottom: -16px;\n      }\n      .stretch .second-line, .stretch ha-themed-slider {\n        width: 100%;\n        --ha-paper-slider-width: 100%;\n      }\n      .nowrap .state-info {\n        min-width: initial;\n      }\n      ha-themed-slider, .top-wrapper {\n        min-width: 100px;\n        max-width: 100%;\n      }\n      .top-wrapper.stretch {\n        display: block;\n      }\n\n      .hidden {\n        display: none;\n      }\n    </style>\n\n    <div id='container' class$='horizontal layout flex top-wrapper [[_computeWrapClass(mode, stretchSlider, lineTooLong, inDialog)]]'>\n      <div class='horizontal layout justified flex-auto state-and-toggle'>\n        <state-info class='state-info' state-obj='[[stateObj]]' in-dialog='[[showLastChanged(stateObj, inDialog, extra)]]' secondary-line$='[[hasExtra(extra)]]' class='flex-auto'>\n          <template is='dom-repeat' items='[[extra]]'>\n            <div>[[item]]</div>\n          </template>\n        </state-info>\n        <template is='dom-if' if='[[breakSlider]]' class='hidden'>\n          <dynamic-with-extra hass='[[hass]]' state-obj='[[stateObj]]' control-element='[[controlElement]]' in-dialog='[[inDialog]]'></dynamic-with-extra>\n        </template>\n      </div>\n      <template is='dom-if' if='[[showSlider]]' restamp>\n        <div class='horizontal layout flex-auto end-justified second-line'>\n          <ha-themed-slider\n            id='slider'\n            max=[[max]]\n            min=[[min]]\n            theme='[[stateObj.attributes.slider_theme]]'\n            is-on='[[isOn(stateObj, nameOn)]]'\n            value='{{sliderValue}}'\n            disable-off-when-min='{{disableOffWhenMin}}'\n            on-change='sliderChanged'\n            on-click='stopPropagation'>\n          </ha-themed-slider>\n          <template is='dom-if' if='[[!breakSlider]]'>\n            <dynamic-with-extra hass='[[hass]]' state-obj='[[stateObj]]' control-element='[[controlElement]]' in-dialog='[[inDialog]]'></dynamic-with-extra>\n          </template>\n        </div>\n      </template>\n    </div>\n    `;\n  }\n\n  static get properties() {\n    return {\n      domain: String,\n      serviceMin: String,\n      serviceMax: String,\n      valueName: String,\n      setValueName: String,\n      nameOn: { type: String, value: 'on' },\n      min: { type: Number, value: 0 },\n      max: { type: Number, value: 255 },\n\n      sliderValue: {\n        type: Number,\n        value: 0,\n      },\n      disableOffWhenMin: Boolean,\n      mode: String,\n      stretchSlider: {\n        type: Boolean,\n        value: false,\n      },\n      breakSlider: {\n        type: Boolean,\n        value: false,\n      },\n      hideSlider: {\n        type: Boolean,\n        value: false,\n      },\n      lineTooLong: {\n        type: Boolean,\n        value: false,\n      },\n      minLineBreak: Number,\n      maxLineBreak: Number,\n      showSlider: {\n        type: Number,\n        computed: '_showSlider(inDialog, stateObj, hideSlider)',\n      },\n    };\n  }\n\n  ready() {\n    super.ready();\n    this._onIronResize = this._onIronResize.bind(this);\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    this._isConnected = true;\n    window.addEventListener('resize', this._onIronResize);\n    this._waitForLayout();\n  }\n\n  disconnectedCallback() {\n    window.removeEventListener('resize', this._onIronResize);\n    this._isConnected = false;\n    super.disconnectedCallback();\n  }\n\n  static get observers() {\n    return [\n      'stateObjChanged(stateObj, nameOn, valueName)',\n    ];\n  }\n\n  _waitForLayout() {\n    if (!this._isConnected) return;\n    this._setMode();\n    if (this._frameId) return;\n    this.readyToCompute = false;\n    this._frameId = window.requestAnimationFrame(() => {\n      this._frameId = null;\n      this.readyToCompute = true;\n      this._onIronResize();\n    });\n  }\n\n  _setMode() {\n    const obj = {\n      hideSlider: this.mode === 'hide-slider' && this.lineTooLong,\n      breakSlider:\n           (this.mode === 'break-slider' || this.mode === 'hide-slider') &&\n           this.lineTooLong,\n    };\n    if (!this.showSlider) {\n      obj.breakSlider = true;\n    }\n    this.setProperties(obj);\n  }\n\n  _onIronResize() {\n    if (!this.readyToCompute) return;\n    if (this.mode === 'no-slider') {\n      this.setProperties({\n        hideSlider: true,\n        breakSlider: true,\n      });\n      return;\n    }\n    const prevBreakSlider = this.breakSlider;\n    const prevHideSlider = this.hideSlider;\n    this.setProperties({\n      lineTooLong: false,\n      hideSlider: false,\n      breakSlider: false,\n    });\n    const { container } = this.$;\n    const containerWidth = container.clientWidth;\n    if (containerWidth === 0) return;\n    if (containerWidth <= this.minLineBreak) {\n      this.lineTooLong = true;\n    } else if (containerWidth >= this.maxLineBreak) {\n      this.lineTooLong = false;\n    } else {\n      if (prevHideSlider && this.mode === 'hide-slider') {\n        // We need to unhide the slider in order to recalculate height.\n        this._waitForLayout();\n        return;\n      }\n      const containerHeight = container.clientHeight;\n      const stateHeight = this.root.querySelector('.state-info').clientHeight;\n      this.lineTooLong = containerHeight > stateHeight * 1.5;\n      if (this.lineTooLong) {\n        this.minLineBreak = containerWidth;\n      } else if (!prevBreakSlider) {\n        this.maxLineBreak = containerWidth;\n      }\n    }\n    this._setMode();\n  }\n\n  _computeWrapClass(mode, stretchSlider, lineTooLong, inDialog) {\n    if (inDialog) {\n      return '';\n    }\n    if (mode === 'single-line') {\n      return 'nowrap';\n    }\n    if (stretchSlider && lineTooLong) {\n      return 'stretch wrap';\n    }\n    return 'wrap';\n  }\n\n  _showSlider(inDialog, stateObj, hideSlider) {\n    if (inDialog || hideSlider) {\n      return false;\n    }\n    return true;\n  }\n\n  sliderChanged(ev) {\n    const value = parseInt(ev.target.value, 10);\n    const param = { entity_id: this.stateObj.entity_id };\n    if (Number.isNaN(value)) return;\n    let target = this.root.querySelector('#slider');\n    if (ev.target !== target) {\n      // No Shadow DOM - we have access to original target.\n      ({ target } = ev);\n    } else if (ev.path) {\n      [target] = ev.path;\n    } else if (ev.composedPath) {\n      [target] = ev.composedPath();\n    }\n    if (value === 0 || (value <= target.min && !this.disableOffWhenMin)) {\n      this.hass.callService(this.domain, this.serviceMin, param);\n    } else {\n      param[this.setValueName || this.valueName] = value;\n      this.hass.callService(this.domain, this.serviceMax, param);\n    }\n  }\n\n  stateObjChanged(stateObj, nameOn, valueName) {\n    const obj = {\n      sliderValue: this.isOn(stateObj, nameOn) ? stateObj.attributes[valueName] : 0,\n    };\n    if (stateObj) {\n      Object.assign(obj, {\n        minLineBreak: 0,\n        maxLineBreak: 999,\n        hideSlider: false,\n        breakSlider: false,\n        lineTooLong: false,\n        mode: stateObj.attributes.state_card_mode,\n        stretchSlider: !!stateObj.attributes.stretch_slider,\n      });\n    }\n    this.setProperties(obj);\n    if (stateObj) {\n      this._waitForLayout();\n    }\n  }\n\n  isOn(stateObj, nameOn) {\n    return stateObj && (!nameOn || stateObj.state === nameOn);\n  }\n\n  stopPropagation(ev) {\n    ev.stopPropagation();\n  }\n}\ncustomElements.define('state-card-with-slider', StateCardWithSlider);\n","import { html } from '@polymer/polymer/lib/utils/html-tag.js';\nimport CuiBaseElement from './cui-base-element.js';\nimport './dynamic-with-extra.js';\n\n/**\n * @extends HTMLElement\n */\nclass StateCardWithoutSlider extends CuiBaseElement {\n  static get template() {\n    return html`\n    <style is=\"custom-style\" include=\"iron-flex iron-flex-alignment\"></style>\n    <style>\n      #container {\n        position: relative;\n      }\n    </style>\n\n    <div id='container' class='horizontal layout justified'>\n      <state-info\n          class='state-info'\n          state-obj='[[stateObj]]'\n          in-dialog='[[showLastChanged(stateObj, inDialog, extra)]]'\n          secondary-line$='[[hasExtra(extra)]]'>\n        <template is='dom-repeat' items='[[extra]]'>\n          <div>[[item]]</div>\n        </template>\n      </state-info>\n      <dynamic-with-extra\n          hass='[[hass]]'\n          state-obj='[[stateObj]]'\n          control-element='[[controlElement]]'\n          in-dialog='[[inDialog]]'>\n      </dynamic-with-extra>\n    </div>\n    `;\n  }\n}\ncustomElements.define('state-card-without-slider', StateCardWithoutSlider);\n","import applyThemesOnElement from '../../home-assistant-polymer/src/common/dom/apply_themes_on_element.js';\nimport computeStateDomain from '../../home-assistant-polymer/src/common/entity/compute_state_domain.js';\nimport dynamicContentUpdater from '../../home-assistant-polymer/src/common/dom/dynamic_content_updater.js';\nimport stateCardType from '../../home-assistant-polymer/src/common/entity/state_card_type.js';\n\nimport '../utils/hooks.js';\nimport './state-card-with-slider.js';\nimport './state-card-without-slider.js';\n\nconst SHOW_LAST_CHANGED_BLACKLISTED_CARDS = ['configurator'];\nconst DOMAIN_TO_SLIDER_SUPPORT = {\n  light: 1, // SUPPORT_BRIGHTNESS\n  cover: 4, // SUPPORT_SET_POSITION\n  climate: 1, // SUPPORT_TARGET_TEMPERATURE\n};\nconst TYPE_TO_CONTROL = {\n  toggle: 'ha-entity-toggle',\n  display: '',\n  cover: 'ha-cover-controls',\n};\n\n/**\n * @extends HTMLElement\n */\nclass StateCardCustomUi extends Polymer.Element {\n  static get properties() {\n    return {\n      hass: Object,\n\n      inDialog: {\n        type: Boolean,\n        value: false,\n      },\n\n      stateObj: Object,\n    };\n  }\n\n  static get observers() {\n    return [\n      'inputChanged(hass, inDialog, stateObj)',\n    ];\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    const container = this.parentNode.parentNode;\n    if (container.tagName === 'DIV' &&\n        (container.classList.contains('state') || container.classList.contains('child-card'))) {\n      this._container = container;\n\n      // Since this doesn't actually change the background - no need to clear it.\n      container.style.setProperty(\n        'background-color', 'var(--paper-card-background-color, inherit)');\n\n      // Polyfill 'updateStyles'.\n      if (!container.updateStyles) {\n        container.updateStyles = (styles) => {\n          Object.keys(styles).forEach((key) => {\n            container.style.setProperty(key, styles[key]);\n          });\n        };\n      }\n    }\n    this._isAttached = true;\n    this.inputChanged(this.hass, this.inDialog, this.stateObj);\n  }\n\n  disconnectedCallback() {\n    this._isAttached = false;\n    if (this._container) {\n      this._container.updateStyles({ display: '', margin: '', padding: '' });\n      applyThemesOnElement(\n        this._container, this.hass.themes || { default_theme: 'default', themes: {} }, 'default');\n      this._container = null;\n    }\n    super.disconnectedCallback();\n  }\n\n  badgeMode(hass, stateObj, domain) {\n    const states = [];\n    if (domain === 'group') {\n      stateObj.attributes.entity_id.forEach((id) => {\n        const state = hass.states[id];\n        if (!state) {\n          /* eslint-disable no-console */\n          console.warn(`Unknown ID ${id} in group ${stateObj.entity_id}`);\n          /* eslint-enable no-console */\n          return;\n        }\n        if (!stateObj.attributes.badges_list ||\n            stateObj.attributes.badges_list.includes(state.entity_id)) {\n          states.push(window.customUI.maybeChangeObject(\n            this, state, false /* inDialog */, false /* allowHidden */));\n        }\n      });\n    } else {\n      states.push(stateObj);\n      if (this._container) {\n        this._container.style.display = 'inline-block';\n        const params = { display: 'inline-block' };\n        if (this._container.classList.contains('state')) {\n          params.margin = 'var(--ha-badges-card-margin, 0)';\n        }\n        this.updateStyles(params);\n      }\n    }\n    dynamicContentUpdater(\n      this,\n      'HA-BADGES-CARD',\n      { hass, states });\n    if (this._container) {\n      this._container.updateStyles({\n        width: 'var(--ha-badges-card-width, initial)',\n        'text-align': 'var(--ha-badges-card-text-align, initial)',\n      });\n    }\n    this.lastChild.style.fontSize = '85%';\n\n    // Since this variable only affects badges mode - no need to clean it up.\n    this.style.setProperty('--ha-state-label-badge-margin-bottom', '0');\n  }\n\n  cleanBadgeStyle() {\n    if (this._container) {\n      this._container.updateStyles({\n        display: '',\n        width: '',\n        'text-align': '',\n      });\n    }\n    this.updateStyles({ display: '', margin: '' });\n  }\n\n  applyThemes(hass, modifiedObj) {\n    let themeTarget = this;\n    let themeName = 'default';\n    if (this._container) {\n      themeTarget = this._container;\n    }\n    if (modifiedObj.attributes.theme) {\n      themeName = modifiedObj.attributes.theme;\n    }\n    applyThemesOnElement(\n      themeTarget, hass.themes || { default_theme: 'default', themes: {} }, themeName);\n  }\n\n  maybeHideEntity(modifiedObj) {\n    if (!modifiedObj) {\n      if (this.lastChild) {\n        this.removeChild(this.lastChild);\n      }\n      if (this._container) {\n        this._container.updateStyles({ margin: '0', padding: '0' });\n      }\n      return true;\n    }\n    if (this._container) {\n      this._container.updateStyles({ margin: '', padding: '' });\n    }\n    return false;\n  }\n\n  sliderEligible_(domain, obj, inDialog) {\n    if (inDialog) return false;\n    return DOMAIN_TO_SLIDER_SUPPORT[domain] &&\n      (DOMAIN_TO_SLIDER_SUPPORT[domain] & obj.attributes.supported_features) &&\n      obj.attributes.state_card_mode && obj.attributes.state_card_mode !== 'no-slider';\n  }\n\n  inputChanged(hass, inDialog, stateObj) {\n    if (!stateObj || !hass || !this._isAttached) return;\n    const domain = computeStateDomain(stateObj);\n    const modifiedObj = window.customUI.maybeChangeObject(\n      this, stateObj, inDialog, true /* allowHidden */);\n\n    if (this.maybeHideEntity(modifiedObj)) return;\n\n    this.applyThemes(hass, modifiedObj);\n\n    if (!inDialog && modifiedObj.attributes.state_card_mode === 'badges') {\n      this.badgeMode(hass, modifiedObj, domain);\n      return;\n    }\n    this.cleanBadgeStyle();\n\n    const params = {\n      hass,\n      stateObj: modifiedObj,\n      inDialog,\n    };\n    const originalStateCardType = stateCardType(hass, stateObj);\n    let customStateCardType;\n    const secondaryStateCardType = modifiedObj.attributes.state_card_custom_ui_secondary;\n\n    if (domain === 'light' && this.sliderEligible_(domain, modifiedObj, inDialog)) {\n      Object.assign(params, {\n        controlElement: 'ha-entity-toggle',\n        serviceMin: 'turn_off',\n        serviceMax: 'turn_on',\n        valueName: 'brightness',\n        domain,\n      });\n      customStateCardType = 'state-card-with-slider';\n    } else if (domain === 'cover' && this.sliderEligible_(domain, modifiedObj, inDialog)) {\n      Object.assign(params, {\n        controlElement: 'ha-cover-controls',\n        max: 100,\n        serviceMin: 'close_cover',\n        serviceMax: 'set_cover_position',\n        setValueName: 'position',\n        valueName: 'current_position',\n        nameOn: 'open',\n        domain,\n      });\n      customStateCardType = 'state-card-with-slider';\n    } else if (domain === 'climate' && this.sliderEligible_(domain, modifiedObj, inDialog)) {\n      Object.assign(params, {\n        controlElement: 'ha-climate-state',\n        min: modifiedObj.attributes.min_temp || -100,\n        max: modifiedObj.attributes.max_temp || 200,\n        serviceMin: 'set_temperature',\n        serviceMax: 'set_temperature',\n        valueName: 'temperature',\n        nameOn: '',\n        domain,\n      });\n      customStateCardType = 'state-card-with-slider';\n    } else if (TYPE_TO_CONTROL[originalStateCardType] !== undefined) {\n      params.controlElement = TYPE_TO_CONTROL[originalStateCardType];\n      customStateCardType = 'state-card-without-slider';\n    } else if (modifiedObj.attributes.show_last_changed &&\n               !SHOW_LAST_CHANGED_BLACKLISTED_CARDS.includes(originalStateCardType)) {\n      params.inDialog = true;\n    }\n    if (modifiedObj.state === 'unavailable') {\n      params.controlElement = '';\n    }\n\n    dynamicContentUpdater(\n      this,\n      (secondaryStateCardType || customStateCardType || `STATE-CARD-${originalStateCardType}`).toUpperCase(),\n      params);\n  }\n}\ncustomElements.define('state-card-custom-ui', StateCardCustomUi);\n","import canToggleDomain from './can_toggle_domain.js';\nimport computeStateDomain from './compute_state_domain.js';\n\nexport default function canToggleState(hass, stateObj) {\n  const domain = computeStateDomain(stateObj);\n  if (domain === 'group') {\n    return stateObj.state === 'on' || stateObj.state === 'off';\n  }\n  if (domain === 'climate') {\n    return !!((stateObj.attributes || {}).supported_features & 4096);\n  }\n\n  return canToggleDomain(hass, domain);\n}\n","export default function canToggleDomain(hass, domain) {\n  const services = hass.config.services[domain];\n  if (!services) { return false; }\n\n  if (domain === 'lock') {\n    return 'lock' in services;\n  } else if (domain === 'cover') {\n    return 'open_cover' in services;\n  }\n  return 'turn_on' in services;\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nwindow.JSCompiler_renameProperty = function(prop) { return prop; };\n"],"sourceRoot":""}