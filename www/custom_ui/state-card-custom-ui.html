<div hidden="" by-polymer-bundler=""><script>window.customUI=window.customUI||{VERSION:"20180126",SUPPORTED_SLIDER_MODES:["single-line","break-slider","break-slider-toggle","hide-slider","no-slider"],domHost(t){if(t===document)return null;const e=t.getRootNode();return e instanceof DocumentFragment?e.host:e},lightOrShadow:(t,e)=>t.shadowRoot?t.shadowRoot.querySelector(e):t.querySelector(e),getElementHierarchy(t,e){if(null===t)return null;const s=e.shift();return s?window.customUI.getElementHierarchy(window.customUI.lightOrShadow(t,s),e):t},getContext(t){if(void 0===t._context){t._context=[];for(let e="HA-ENTITIES-CARD"===t.tagName?window.customUI.domHost(t):t;e;e=window.customUI.domHost(e))switch(e.tagName){case"HA-ENTITIES-CARD":e.groupEntity?t._context.push(e.groupEntity.entity_id):!1===e.groupEntity&&e.states&&e.states.length&&t._context.push(`group.${window.hassUtil.computeDomain(e.states[0])}`);break;case"MORE-INFO-GROUP":case"STATE-CARD-CONTENT":e.stateObj&&t._context.push(e.stateObj.entity_id);break;case"HA-CARDS":t._context.push(e.getAttribute("data-view")||"default_view")}t._context.reverse()}return t._context},findMatch:(t,e)=>e?e[t]?t:Object.keys(e).find(e=>t.match(`^${e}$`)):null,maybeChangeObjectByDevice(t){const e=window.customUI.getName();if(!e)return t;const s=this.findMatch(e,t.attributes.device);if(!s)return t;const o=Object.assign({},t.attributes.device[s]);return Object.keys(o).length?window.customUI.applyAttributes(t,o):t},maybeChangeObjectByGroup(t,e){const s=window.customUI.getContext(t);if(!s)return e;if(!e.attributes.group)return e;const o={};return s.forEach(t=>{const s=this.findMatch(t,e.attributes.group);e.attributes.group[s]&&Object.assign(o,e.attributes.group[s])}),Object.keys(o).length?window.customUI.applyAttributes(e,o):e},_setKeep(t,e){void 0===t._cui_keep?t._cui_keep=e:t._cui_keep=t._cui_keep&&e},maybeApplyTemplateAttributes(t,e,s,o){if(!o.templates)return window.customUI._setKeep(s,!0),s;const i={};let n=!1,a=!1;if(Object.keys(o.templates).forEach(r=>{const u=o.templates[r];u.match(/\b(entities|hass)\b/)&&(n=!0);const c=window.customUI.computeTemplate(u,t,e,s,o,o[r],s.state);i[r]=c,"state"===r?c!==s.state&&(a=!0):"_stateDisplay"===r?c!==s._stateDisplay&&(a=!0):c!==o[r]&&(a=!0)}),window.customUI._setKeep(s,!n),!a)return s;if(s.attributes===o){const t=window.customUI.applyAttributes(s,i);return Object.prototype.hasOwnProperty.call(i,"state")&&(t.state=i.state),Object.prototype.hasOwnProperty.call(i,"_stateDisplay")&&(t._stateDisplay=i._stateDisplay),window.customUI._setKeep(t,!n),t}return Object.assign({},s)},maybeApplyTemplates(t,e,s){const o=window.customUI.maybeApplyTemplateAttributes(t,e,s,s.attributes);let i=o!==s;function n(s){s&&(Object.values(s).forEach(s=>{const n=window.customUI.maybeApplyTemplateAttributes(t,e,o,s);i|=n!==o}),n(s.device),n(s.group))}return n(s.attributes.device),n(s.attributes.group),o!==s?o:i?Object.assign({},s):s},applyAttributes:(t,e)=>({entity_id:t.entity_id,state:t.state,attributes:Object.assign({},t.attributes,e),last_changed:t.last_changed}),maybeChangeObject(t,e,s,o){if(s)return e;let i=window.customUI.maybeChangeObjectByDevice(e);return i=window.customUI.maybeChangeObjectByGroup(t,i),(i=window.customUI.maybeApplyTemplateAttributes(t.hass,t.hass.states,i,i.attributes))!==e&&i.attributes.hidden&&o?null:i},fixGroupTitles(){const t=window.customUI.getElementHierarchy(document,["home-assistant","home-assistant-main"]);if(null===t)return void window.setTimeout(window.customUI.fixGroupTitles,1e3);const e=window.customUI.getElementHierarchy(t,["partial-cards","ha-cards[view-visible]"]);null!==e&&(window.customUI.lightOrShadow(e,".main")||e.$.main).querySelectorAll("ha-entities-card").forEach(t=>{if(t.groupEntity){const e=window.customUI.maybeChangeObject(t,t.groupEntity,!1,!1);if(e!==t.groupEntity&&e.attributes.friendly_name)window.customUI.lightOrShadow(t,".name").textContent=e.attributes.friendly_name}})},showVersion(){if("/dev-info"!==window.location.pathname)return;const t=window.customUI.getElementHierarchy(document,["home-assistant","home-assistant-main","partial-panel-resolver","ha-panel-dev-info"]);if(null===t)return void window.setTimeout(window.customUI.showVersion,1e3);const e=window.customUI.lightOrShadow(t,".about"),s=e.querySelectorAll("p")[1],o=document.createElement("p");o.textContent=`Custom UI ${window.customUI.VERSION}`,e.insertBefore(o,s)},controlColumns(t){const e=window.customUI.getElementHierarchy(document,["home-assistant","home-assistant-main","partial-cards"]);null!==e?(e.mqls.forEach(t=>{t.removeListener(e.handleWindowChange)}),e.mqls=t.map(t=>{const s=window.matchMedia(`(min-width: ${t}px)`);return s.addListener(e.handleWindowChange),s}),e.handleWindowChange()):window.setTimeout(window.customUI.controlColumns.bind(null,t),1e3)},useCustomizer(){const t=window.customUI.lightOrShadow(document,"home-assistant").hass.states["customizer.customizer"];t&&(t.attributes.columns&&window.customUI.controlColumns(t.attributes.columns),t.attributes.hide_attributes&&(window.hassUtil.LOGIC_STATE_ATTRIBUTES&&Array.prototype.push.apply(window.hassUtil.LOGIC_STATE_ATTRIBUTES,t.attributes.hide_attributes),window.hassAttributeUtil.LOGIC_STATE_ATTRIBUTES&&t.attributes.hide_attributes.forEach(t=>{Object.prototype.hasOwnProperty.call(window.hassAttributeUtil.LOGIC_STATE_ATTRIBUTES,t)||(window.hassAttributeUtil.LOGIC_STATE_ATTRIBUTES[t]=void 0)})))},updateAttributes(){const t={group:void 0,device:void 0,templates:void 0,state_card_mode:{type:"array",options:{light:window.customUI.SUPPORTED_SLIDER_MODES.concat("badges"),cover:window.customUI.SUPPORTED_SLIDER_MODES.concat("badges"),"*":["badges"]}},state_card_custom_ui_secondary:{type:"string"},badges_list:{type:"json"},show_last_changed:{type:"boolean"},hide_control:{type:"boolean"},extra_data_template:{type:"string"},extra_badge:{type:"json"},stretch_slider:{type:"boolean"},slider_theme:{type:"json"},theme:{type:"string"},confirm_controls:{type:"boolean"},confirm_controls_show_lock:{type:"boolean"},hide_in_default_view:{type:"boolean"}};window.hassUtil.LOGIC_STATE_ATTRIBUTES&&Array.prototype.push.apply(window.hassUtil.LOGIC_STATE_ATTRIBUTES,Object.keys(t)),window.hassAttributeUtil.LOGIC_STATE_ATTRIBUTES&&Object.assign(window.hassAttributeUtil.LOGIC_STATE_ATTRIBUTES,t)},updateConfigPanel(){if(!window.location.pathname.startsWith("/config"))return;const t=window.customUI.getElementHierarchy(document,["home-assistant","home-assistant-main","partial-panel-resolver","ha-panel-config"]);if(!t)return void window.setTimeout(window.customUI.updateConfigPanel,1e3);const e=window.customUI.lightOrShadow(t,"iron-pages");if(!e)return;const s=window.customUI.getElementHierarchy(t,["ha-config-dashboard","ha-config-navigation"]);if(s){if("HA-CONFIG-CUSTOM-UI"!==e.lastElementChild.tagName){const t=document.createElement("ha-config-custom-ui");t.isWide=window.customUI.domHost(e).isWide,t.setAttribute("page-name","customui"),e.appendChild(t),e.addEventListener("iron-items-changed",()=>{window.location.pathname.startsWith("/config/customui")&&e.select("customui")})}s.pages.some(t=>"customui"===t.domain)||s.push("pages",{domain:"customui",caption:"Custom UI",description:"Set UI tweaks.",loaded:!0})}},installStatesHook(){const t=customElements.get("home-assistant");if(!t||!t.prototype._updateHass)return;const e=t.prototype._updateHass;t.prototype._updateHass=function(t){const{hass:s}=this;t.states&&Object.keys(t.states).forEach(e=>{const o=t.states[e];if(o._cui_keep)return;const i=window.customUI.maybeApplyTemplates(s,t.states,o);s.states&&o!==s.states[e]?t.states[e]=i:o!==i&&(t.states[e]=i)}),e.call(this,t)};const s=window.customUI.lightOrShadow(document,"home-assistant");s.hass&&s.hass.states&&s._updateHass({states:s.hass.states})},installPartialCards(){const t=customElements.get("partial-cards");t&&t.prototype._defaultViewFilter&&(t.prototype._defaultViewFilter=((t,e)=>{if(t.states[e].attributes.hidden)return!1;const s={};return Object.values(t.states).forEach(e=>{if(e.attributes&&e.attributes.hide_in_default_view){const o=e.entity_id;if(s[o])return;s[o]=e,e.attributes.view&&Object.assign(s,window.HAWS.getViewEntities(t.states,e))}}),!s[e]}))},installHaStateLabelBadge(){const t=customElements.get("ha-state-label-badge");t&&t.prototype.stateChanged&&(t.prototype.stateChanged=function(t){window.hassUtil.applyThemesOnElement(this,this.hass.themes||{default_theme:"default",themes:{}},t.attributes.theme||"default"),this.updateStyles(),this.startInterval&&this.startInterval(t)})},installClassHooks(){window.customUI.classInitDone||(window.customUI.classInitDone=!0,window.customUI.installPartialCards(),window.customUI.installStatesHook(),window.customUI.installHaStateLabelBadge())},init(){if(window.customUI.initDone)return;window.customUI.installClassHooks();const t=window.customUI.lightOrShadow(document,"home-assistant");t.hass&&t.hass.states?(window.customUI.initDone=!0,window.customUI.useCustomizer(),window.customUI.runHooks(),window.addEventListener("location-changed",window.setTimeout.bind(null,window.customUI.runHooks,100)),console.log(`Loaded CustomUI ${window.customUI.VERSION}`)):window.setTimeout(window.customUI.init,1e3)},runHooks(){window.customUI.fixGroupTitles(),window.customUI.showVersion(),window.customUI.updateAttributes(),window.customUI.updateConfigPanel()},getName:()=>window.localStorage.getItem("ha-device-name")||"",setName(t){window.localStorage.setItem("ha-device-name",t||"")},computeTemplate(t,e,s,o,i,n,a){const r=t.indexOf("return")>=0?t:`return \`${t}\`;`;try{return new Function("hass","entities","entity","attributes","attribute","state",r)(e,s,o,i,n,a)}catch(t){if(t instanceof SyntaxError||t instanceof ReferenceError)return console.warn(`${t.name}: ${t.message} in template ${r}`),null;throw t}}},window.customUI.init();</script><dom-module id="ha-config-custom-ui"><template><style include="ha-style"></style><app-header-layout has-scrolling-region=""><app-header slot="header" fixed=""><app-toolbar><paper-icon-button icon="mdi:arrow-left" on-tap="_backTapped"></paper-icon-button><div main-title="">Custom UI settings</div></app-toolbar></app-header><ha-config-section is-wide="[[isWide]]"><paper-card heading="Device name"><div class="card-content">Set device name so that you can reference it in per-device settings<paper-input label="Name" value="{{name}}"></paper-input></div></paper-card></ha-config-section></app-header-layout></template></dom-module><script>class HaConfigCustomUi extends Polymer.Element{static get is(){return"ha-config-custom-ui"}static get properties(){return{isWide:Boolean,name:{type:String,observer:"nameChanged"}}}ready(){super.ready(),this.name=window.customUI.getName()}nameChanged(e){window.customUI.setName(e)}_backTapped(){window.history.back()}}customElements.define(HaConfigCustomUi.is,HaConfigCustomUi);</script><script>class CuiBaseElement extends Polymer.Element{static get properties(){return{hass:Object,inDialog:{type:Boolean,value:!1},stateObj:Object,controlElement:String,extra:{type:Array,computed:"computeExtra(hass, stateObj)"}}}computeExtra(t,e){let a=e.attributes.extra_data_template;return a?(Array.isArray(a)||(a=[a]),a.map(a=>window.customUI.computeTemplate(a,t,t.states,e,e.attributes,void 0,e.state)).filter(t=>null!==t)):[]}showLastChanged(t,e,a){return!!e||!a.length&&!!t.attributes.show_last_changed}hasExtra(t){return t.length>0}}</script><script>class DynamicElement extends Polymer.Element{static get is(){return"dynamic-element"}static get properties(){return{hass:Object,stateObj:Object,elementName:String,inDialog:{type:Boolean,value:!1}}}static get observers(){return["observerFunc(hass, stateObj, elementName, inDialog)"]}observerFunc(e,t,n,s){window.hassUtil.dynamicContentUpdater(this,n?n.toUpperCase():"DIV",{hass:e,stateObj:t,inDialog:s})}}customElements.define(DynamicElement.is,DynamicElement);</script><dom-module id="dynamic-with-extra"><template><style is="custom-style" include="iron-flex iron-flex-alignment iron-flex-factors"></style><style>:host{display:inline-block}.control-wrapper{margin:-4px -16px -4px 0;padding:4px 16px}ha-state-label-badge{margin-left:8px}dynamic-element{display:block;text-align:right}#overlay{position:absolute;left:0;right:0;top:0;bottom:0;text-align:right}#lock{margin-top:8px;opacity:.3;margin-right:7px}#lock.ha-cover-controls{margin-right:52px;background-color:#fff}.extra{margin-bottom:-16px;--ha-label-badge-size:36px;--ha-label-badge-font-size:1.2em}.state{@apply(--paper-font-body1);color:var(--primary-text-color);margin-left:16px;text-align:right;line-height:40px}</style><div class$="[[extraClass(extraObjVisible)]] horizontal layout"><template is="dom-if" if="[[extraObjVisible]]"><template is="dom-repeat" items="[[extraObj]]" on-dom-change="extraDomChanged"><ha-state-label-badge hass="[[hass]]" state="[[item]]"></ha-state-label-badge></template></template><template is="dom-if" if="[[_showControl(inDialog, stateObj)]]"><template is="dom-if" if="[[controlElement]]"><div class="control-wrapper"><dynamic-element class="flex" state-obj="[[stateObj]]" hass="[[hass]]" element-name="[[controlElement]]"></dynamic-element><template is="dom-if" if="[[isConfirmControls(stateObj)]]"><div id="overlay" on-tap="tapHandler"><template is="dom-if" if="[[stateObj.attributes.confirm_controls_show_lock]]"><iron-icon id="lock" class$="[[controlElement]]" icon="mdi:lock-outline"></iron-icon></template></div></template></div></template><template is="dom-if" if="[[!controlElement]]"><div class="state">[[computeStateDisplay(stateObj)]]</div></template></template></div></template></dom-module><script>class DynamicWithExtra extends(StateCardDisplay||Polymer.Element){static get is(){return"dynamic-with-extra"}static get properties(){return{hass:Object,inDialog:{type:Boolean,value:!1},stateObj:Object,controlElement:String,extraObj:{type:Array,computed:"computeExtra(hass, stateObj, _attached)"},_attached:Boolean,extraObjVisible:{type:Boolean,computed:"computeExtraVisible(extraObj, inDialog)"}}}connectedCallback(){super.connectedCallback(),this._attached=!0}disconnectedCallback(){this._isAttached=!1,super.disconnectedCallback()}computeExtra(t,e,a){if(!e.attributes.extra_badge||!a)return[];let i=e.attributes.extra_badge;return Array.isArray(i)||(i=[i]),i.map(a=>{let i=null;if(a.entity_id&&t.states[a.entity_id]?i=Object.assign({},window.customUI.maybeChangeObject(this,t.states[a.entity_id],this.inDialog,!1)):a.attribute&&void 0!==e.attributes[a.attribute]&&(i={state:String(e.attributes[a.attribute]),_domain:"none",entity_id:null,attributes:{unit_of_measurement:a.unit}}),!i)return null;let s=a.blacklist_states;return s&&(Array.isArray(s)||(s=[s]),s.some(t=>RegExp(t).test(i.state.toString())))?null:(i._entityDisplay="",i)}).filter(t=>null!=t)}computeExtraVisible(t,e){return!(e||!t)&&0!==t.length}extraClass(t){return t?"extra":""}_showControl(t,e){return!!t||!e.attributes.hide_control}computeStateDisplay(t){return window.hassUtil.computeStateState?window.hassUtil.computeStateState(t):super.computeStateDisplay(this.haLocalize||this.localize,t)}isConfirmControls(t){return t.attributes.confirm_controls||t.attributes.confirm_controls_show_lock}tapHandler(t){this.$$("#overlay").style.pointerEvents="none";const e=this.$$("#lock");e&&(e.icon="mdi:lock-open-outline",e.style.opacity="0.1"),window.setTimeout(()=>{this.$$("#overlay").style.pointerEvents="",e&&(e.icon="mdi:lock-outline",e.style.opacity="")},5e3),t.stopPropagation()}applyThemes(t,e,a){const i=a.attributes.theme||"default";window.hassUtil.applyThemesOnElement(e,t.themes||{default_theme:"default",themes:{}},i)}extraDomChanged(){this.root.querySelectorAll("ha-state-label-badge").forEach(t=>{this.applyThemes(this.hass,t,t.state)})}}customElements.define(DynamicWithExtra.is,DynamicWithExtra);</script><dom-module id="ha-themed-slider"><template><style>:host{margin:var(--ha-themed-slider-margin,initial)}.disable-off-when-min{--paper-slider-pin-start-color:var(--paper-slider-pin-color)}.disable-off-when-min.is-on{--paper-slider-knob-start-color:var(--paper-slider-knob-color);--paper-slider-knob-start-border-color:var(--paper-slider-knob-color)}paper-slider{margin:4px 0;max-width:100%;min-width:100px;width:var(--ha-paper-slider-width,200px)}</style><paper-slider min="[[_themedMin]]" max="[[_computeAttribute(theme, &quot;max&quot;, max)]]" pin="[[_computeAttribute(theme, &quot;pin&quot;, pin)]]" class$="[[computeClass(theme, isOn, _themedMin)]]" value="[[value]]" on-change="valueChanged"></paper-slider></template></dom-module><script>class HaThemedSlider extends Polymer.Element{static get is(){return"ha-themed-slider"}ready(){super.ready(),this.value=this.value+1,this.value=this.value-1,this.disableOffWhenMin=!this._computeAttribute(this.theme,"off_when_min",!this.disableOffWhenMin),this.computeEnabledThemedReportWhenNotChanged(this.theme,this.disableReportWhenNotChanged)}static get properties(){return{min:{type:Number,value:0},max:{type:Number,value:100},pin:{type:Boolean,value:!1},isOn:{type:Boolean,value:!1},disableOffWhenMin:{type:Boolean,value:!1,notify:!0},disableReportWhenNotChanged:{type:Boolean,value:!1},theme:Object,value:{type:Number,notify:!0},_themedMin:{type:Number,computed:'_computeAttribute(theme, "min", min)'}}}static get observers(){return["computeEnabledThemedReportWhenNotChanged(theme, disableReportWhenNotChanged)"]}computeEnabledThemedReportWhenNotChanged(e,t){this._enabledThemedReportWhenNotChanged=this._computeAttribute(e,"report_when_not_changed",!t)}_computeAttribute(e,t,n){return e&&t in e?e[t]:n}computeClass(e,t,n){let h="";return t&&(h+="is-on "),this._computeAttribute(e,"off_when_min",!this.disableOffWhenMin)||0===n?"":`${h}disable-off-when-min`}valueChanged(e){this._enabledThemedReportWhenNotChanged||this.value!==e.target.value?this.value=e.target.value:e.stopPropagation()}}customElements.define(HaThemedSlider.is,HaThemedSlider);</script><dom-module id="state-card-with-slider"><template><style is="custom-style" include="iron-flex iron-flex-alignment iron-flex-factors"></style><style>#container{position:relative}.second-line,.state-and-toggle,.state-info{max-width:100%}.nowrap .state-and-toggle{overflow:hidden;flex-grow:0}.nowrap .second-line{overflow:hidden}.second-line{padding-top:20px;padding-bottom:16px;margin-top:-20px;margin-bottom:-16px}.stretch .second-line,.stretch ha-themed-slider{width:100%;--ha-paper-slider-width:100%}.nowrap .state-info{min-width:initial}.top-wrapper,ha-themed-slider{min-width:100px;max-width:100%}.top-wrapper.stretch{display:block}.hidden{display:none}</style><div id="container" class$="horizontal layout flex top-wrapper [[_computeWrapClass(mode, stretchSlider, lineTooLong, inDialog)]]"><div class="horizontal layout justified flex-auto state-and-toggle"><state-info class="state-info" state-obj="[[stateObj]]" in-dialog="[[showLastChanged(stateObj, inDialog, extra)]]" secondary-line$="[[hasExtra(extra)]]"><template is="dom-repeat" items="[[extra]]"><div>[[item]]</div></template></state-info><template is="dom-if" if="[[breakSlider]]" class="hidden"><dynamic-with-extra hass="[[hass]]" state-obj="[[stateObj]]" control-element="[[controlElement]]" in-dialog="[[inDialog]]"></dynamic-with-extra></template></div><template is="dom-if" if="[[showSlider]]" restamp=""><div class="horizontal layout flex-auto end-justified second-line"><ha-themed-slider id="slider" max="[[max]]" min="[[min]]" theme="[[stateObj.attributes.slider_theme]]" is-on="[[isOn(stateObj, nameOn)]]" value="{{sliderValue}}" disable-off-when-min="{{disableOffWhenMin}}" on-change="sliderChanged" on-tap="stopPropagation"></ha-themed-slider><template is="dom-if" if="[[!breakSlider]]"><dynamic-with-extra hass="[[hass]]" state-obj="[[stateObj]]" control-element="[[controlElement]]" in-dialog="[[inDialog]]"></dynamic-with-extra></template></div></template></div></template></dom-module><script>class StateCardWithSlider extends(Polymer.mixinBehaviors([Polymer.IronResizableBehavior],CuiBaseElement)){static get is(){return"state-card-with-slider"}static get properties(){return{domain:String,serviceMin:String,serviceMax:String,valueName:String,setValueName:String,nameOn:{type:String,value:"on"},min:{type:Number,value:0},max:{type:Number,value:255},sliderValue:{type:Number,value:0},disableOffWhenMin:Boolean,mode:String,stretchSlider:{type:Boolean,value:!1},breakSlider:{type:Boolean,value:!1},hideSlider:{type:Boolean,value:!1},lineTooLong:{type:Boolean,value:!1},minLineBreak:Number,maxLineBreak:Number,showSlider:{type:Number,computed:"_showSlider(inDialog, stateObj, hideSlider)"}}}ready(){super.ready(),this._onIronResize=this._onIronResize.bind(this)}connectedCallback(){super.connectedCallback(),this.addEventListener("iron-resize",this._onIronResize),this._waitForLayout()}disconnectedCallback(){this.removeEventListener("iron-resize",this._onIronResize),super.disconnectedCallback()}static get observers(){return["stateObjChanged(stateObj, nameOn, valueName)"]}_waitForLayout(){this._setMode(),this._frameId||(this.readyToCompute=!1,this._frameId=window.requestAnimationFrame(()=>{this._frameId=null,this.readyToCompute=!0,this._onIronResize()}))}_setMode(){const e={hideSlider:"hide-slider"===this.mode&&this.lineTooLong,breakSlider:("break-slider"===this.mode||"hide-slider"===this.mode)&&this.lineTooLong};this.showSlider||(e.breakSlider=!0),this.setProperties(e)}_onIronResize(){if(!this.readyToCompute)return;if("no-slider"===this.mode)return void this.setProperties({hideSlider:!0,breakSlider:!0});const e=this.breakSlider,i=this.hideSlider;this.setProperties({lineTooLong:!1,hideSlider:!1,breakSlider:!1});const{container:t}=this.$,s=t.clientWidth;if(0!==s){if(s<=this.minLineBreak)this.lineTooLong=!0;else if(s>=this.maxLineBreak)this.lineTooLong=!1;else{if(i&&"hide-slider"===this.mode)return void this._waitForLayout();const r=t.clientHeight,a=this.$$(".state-info").clientHeight;this.lineTooLong=r>1.5*a,this.lineTooLong?this.minLineBreak=s:e||(this.maxLineBreak=s)}this._setMode()}}_computeWrapClass(e,i,t,s){return s?"":"single-line"===e?"nowrap":i&&t?"stretch wrap":"wrap"}_showSlider(e,i,t){return!e&&!t}sliderChanged(e){const i=parseInt(e.target.value,10),t={entity_id:this.stateObj.entity_id};if(Number.isNaN(i))return;let s=this.$$("#slider");e.target!==s?({target:s}=e):e.path?[s]=e.path:e.composedPath&&([s]=e.composedPath()),0===i||i<=s.min&&!this.disableOffWhenMin?this.hass.callService(this.domain,this.serviceMin,t):(t[this.setValueName||this.valueName]=i,this.hass.callService(this.domain,this.serviceMax,t))}stateObjChanged(e,i,t){if(this.isOn(e,i)?this.sliderValue=e.attributes[t]:this.sliderValue=0,e){const i={minLineBreak:0,maxLineBreak:999,hideSlider:!1,breakSlider:!1,lineTooLong:!1,mode:e.attributes.state_card_mode,stretchSlider:!!e.attributes.stretch_slider};this.setProperties(i),this._waitForLayout()}}isOn(e,i){return e&&(!i||e.state===i)}stopPropagation(e){e.stopPropagation()}}customElements.define(StateCardWithSlider.is,StateCardWithSlider);</script><dom-module id="state-card-without-slider"><template><style is="custom-style" include="iron-flex iron-flex-alignment"></style><style>#container{position:relative}</style><div id="container" class="horizontal layout justified"><state-info class="state-info" state-obj="[[stateObj]]" in-dialog="[[showLastChanged(stateObj, inDialog, extra)]]" secondary-line$="[[hasExtra(extra)]]"><template is="dom-repeat" items="[[extra]]"><div>[[item]]</div></template></state-info><dynamic-with-extra hass="[[hass]]" state-obj="[[stateObj]]" control-element="[[controlElement]]" in-dialog="[[inDialog]]"></dynamic-with-extra></div></template></dom-module><script>class StateCardWithoutSlider extends CuiBaseElement{static get is(){return"state-card-without-slider"}}customElements.define(StateCardWithoutSlider.is,StateCardWithoutSlider);</script><script>{const t=["configurator"],e={light:1,cover:4,climate:1},i={toggle:"ha-entity-toggle",display:"",cover:"ha-cover-controls"};class a extends Polymer.Element{static get is(){return"state-card-custom-ui"}static get properties(){return{hass:Object,inDialog:{type:Boolean,value:!1},stateObj:Object}}static get observers(){return["inputChanged(hass, inDialog, stateObj)"]}connectedCallback(){super.connectedCallback();const t=this.parentNode.parentNode;"DIV"===t.tagName&&(t.classList.contains("state")||t.classList.contains("child-card"))&&(this._container=t,t.style.setProperty("background-color","var(--paper-card-background-color, inherit)"),t.updateStyles||(t.updateStyles=(e=>{Object.keys(e).forEach(i=>{t.style.setProperty(i,e[i])})}))),this._isAttached=!0,this.inputChanged(this.hass,this.inDialog,this.stateObj)}disconnectedCallback(){this._isAttached=!1,this._container&&(this._container.updateStyles({display:"",margin:"",padding:""}),window.hassUtil.applyThemesOnElement(this._container,this.hass.themes||{default_theme:"default",themes:{}},"default"),this._container=null),super.disconnectedCallback()}badgeMode(t,e,i){const a=[];if("group"===i)e.attributes.entity_id.forEach(i=>{const s=t.states[i];s?e.attributes.badges_list&&!e.attributes.badges_list.includes(s.entity_id)||a.push(window.customUI.maybeChangeObject(this,s,!1,!1)):console.warn(`Unknown ID ${i} in group ${e.entity_id}`)});else if(a.push(e),this._container){this._container.style.display="inline-block";const t={display:"inline-block"};this._container.classList.contains("state")&&(t.margin="var(--ha-badges-card-margin, 0 -6px)"),this.updateStyles(t)}window.hassUtil.dynamicContentUpdater(this,"HA-BADGES-CARD",{hass:t,states:a}),this._container&&this._container.updateStyles({width:"var(--ha-badges-card-width, initial)","text-align":"var(--ha-badges-card-text-align, initial)"}),this.lastChild.style.fontSize="85%",this.style.setProperty("--ha-state-label-badge-margin-bottom","0")}cleanBadgeStyle(){this._container&&this._container.updateStyles({display:"",width:"","text-align":""}),this.updateStyles({display:"",margin:""})}applyThemes(t,e){let i=this,a="default";this._container&&(i=this._container),e.attributes.theme&&(a=e.attributes.theme),window.hassUtil.applyThemesOnElement(i,t.themes||{default_theme:"default",themes:{}},a)}maybeHideEntity(t){return t?(this._container&&this._container.updateStyles({margin:"",padding:""}),!1):(this.lastChild&&this.removeChild(this.lastChild),this._container&&this._container.updateStyles({margin:"0",padding:"0"}),!0)}sliderEligible_(t,i,a){return!a&&(e[t]&&e[t]&i.attributes.supported_features&&i.attributes.state_card_mode&&"no-slider"!==i.attributes.state_card_mode)}inputChanged(e,a,s){if(!s||!e||!this._isAttached)return;const n=window.hassUtil.computeDomain(s),r=window.customUI.maybeChangeObject(this,s,a,!0);if(this.maybeHideEntity(r))return;if(this.applyThemes(e,r),!a&&"badges"===r.attributes.state_card_mode)return void this.badgeMode(e,r,n);this.cleanBadgeStyle();const l={hass:e,stateObj:r,inDialog:a},o=window.hassUtil.stateCardType(e,s);let c;const d=r.attributes.state_card_custom_ui_secondary;"light"===n&&this.sliderEligible_(n,r,a)?(Object.assign(l,{controlElement:"ha-entity-toggle",serviceMin:"turn_off",serviceMax:"turn_on",valueName:"brightness",domain:n}),c="state-card-with-slider"):"cover"===n&&this.sliderEligible_(n,r,a)?(Object.assign(l,{controlElement:"ha-cover-controls",max:100,serviceMin:"close_cover",serviceMax:"set_cover_position",setValueName:"position",valueName:"current_position",nameOn:"open",domain:n}),c="state-card-with-slider"):"climate"===n&&this.sliderEligible_(n,r,a)?(Object.assign(l,{controlElement:"ha-climate-state",min:r.attributes.min_temp||-100,max:r.attributes.max_temp||200,serviceMin:"set_temperature",serviceMax:"set_temperature",valueName:"temperature",nameOn:"",domain:n}),c="state-card-with-slider"):void 0!==i[o]?(l.controlElement=i[o],c="state-card-without-slider"):r.attributes.show_last_changed&&!t.includes(o)&&(l.inDialog=!0),"unavailable"===r.state&&(l.controlElement=""),window.hassUtil.dynamicContentUpdater(this,(d||c||`STATE-CARD-${o}`).toUpperCase(),l)}}customElements.define(a.is,a)}</script></div>